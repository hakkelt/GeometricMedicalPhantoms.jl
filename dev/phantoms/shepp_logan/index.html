<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Shepp-Logan Phantom · GeometricMedicalPhantoms.jl</title><meta name="title" content="Shepp-Logan Phantom · GeometricMedicalPhantoms.jl"/><meta property="og:title" content="Shepp-Logan Phantom · GeometricMedicalPhantoms.jl"/><meta property="twitter:title" content="Shepp-Logan Phantom · GeometricMedicalPhantoms.jl"/><meta name="description" content="Documentation for GeometricMedicalPhantoms.jl."/><meta property="og:description" content="Documentation for GeometricMedicalPhantoms.jl."/><meta property="twitter:description" content="Documentation for GeometricMedicalPhantoms.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.png" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeometricMedicalPhantoms.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeometricMedicalPhantoms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Phantoms</span><ul><li class="is-active"><a class="tocitem" href>Shepp-Logan Phantom</a><ul class="internal"><li><a class="tocitem" href="#History-and-Design-Philosophy"><span>History and Design Philosophy</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Intensity-Variants"><span>Intensity Variants</span></a></li><li><a class="tocitem" href="#Tissue-Masking"><span>Tissue Masking</span></a></li><li><a class="tocitem" href="#Advanced-Parameters"><span>Advanced Parameters</span></a></li></ul></li><li><a class="tocitem" href="../torso/">Torso Phantom</a></li><li><a class="tocitem" href="../tubes/">Tubes Phantom</a></li></ul></li><li><span class="tocitem">Advanced</span><ul><li><a class="tocitem" href="../phantom_specification/">Torso Phantom Specification</a></li><li><a class="tocitem" href="../../advanced/primitives/">Geometry Primitives</a></li><li><a class="tocitem" href="../../advanced/custom_phantoms/">Custom Phantoms</a></li></ul></li><li><a class="tocitem" href="../../cli/">CLI</a></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Phantoms</a></li><li class="is-active"><a href>Shepp-Logan Phantom</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Shepp-Logan Phantom</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hakkelt/GeometricMedicalPhantoms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hakkelt/GeometricMedicalPhantoms.jl/blob/master/docs/src/phantoms/shepp_logan.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Shepp-Logan-Phantom"><a class="docs-heading-anchor" href="#Shepp-Logan-Phantom">Shepp-Logan Phantom</a><a id="Shepp-Logan-Phantom-1"></a><a class="docs-heading-anchor-permalink" href="#Shepp-Logan-Phantom" title="Permalink"></a></h1><p>The Shepp-Logan phantom is the classic test phantom in medical imaging. First introduced by Shepp and Logan in 1974, it represents a simplified model of the human head using overlapping ellipses, making it ideal for testing image reconstruction algorithms and understanding imaging physics.</p><h2 id="History-and-Design-Philosophy"><a class="docs-heading-anchor" href="#History-and-Design-Philosophy">History and Design Philosophy</a><a id="History-and-Design-Philosophy-1"></a><a class="docs-heading-anchor-permalink" href="#History-and-Design-Philosophy" title="Permalink"></a></h2><p>The original 2D phantom (Shepp &amp; Logan, 1974) was designed as a synthetic test image for CT reconstruction, composed of 10 ellipses with different attenuation coefficients. A more detailed 3D version was proposed in 1980 by the same researchers, but it didn&#39;t become widely used. In 1988, Kak and Slaney popularized its use in the context of filtered backprojection algorithms, and defined a 3D version using 10 ellipsoids. It became the standard test case because:</p><ul><li><strong>Simplicity</strong>: Easy to generate and understand</li><li><strong>Reproducibility</strong>: Well-defined mathematical structure enables precise comparisons</li></ul><p>The MRI variant (Toft, 1996) adapted intensity values for nuclear magnetic resonance instead of X-ray attenuation, scaling to realistic MRI signal ranges. Also in 1996, Caroline Jacobson suggested adding two extra ellipsoids to the 3D version to better match the original 2D design.</p><p>GeometricMedicalPhantoms.jl implements Jacobson&#39;s version, but it differs from it by a <strong>shift in z-axis</strong> by 0.25. This adjustment makes the connection between the original 2D phantom and the 3D volume more intuitive by centering the axial slice that matches the 2D phantom.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><p>[1] L. A. Shepp and B. F. Logan, “The Fourier reconstruction of a head section,” IEEE Trans. Nucl. Sci., 1974. [2] L. A. Shepp, “Computerized tomography and nuclear magnetic resonance,” 1980. [3] A. C. Kak and M. Slaney, Principles of Computerized Tomographic Imaging. IEEE Press, 1988. [4] P. A. Toft, “The Radon Transform - Theory and Implementation,” PhD Thesis, 1996. [5] C. Jacobson, “Fourier Methods in 3D-Reconstruction from Cone-Beam Data,” PhD Thesis, Department of Electrical Engineering, Linköping University, Linköping, Sweden, 1996.</p><h3 id="Comparison-with-ImagePhantoms.jl"><a class="docs-heading-anchor" href="#Comparison-with-ImagePhantoms.jl">Comparison with ImagePhantoms.jl</a><a id="Comparison-with-ImagePhantoms.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-ImagePhantoms.jl" title="Permalink"></a></h3><p>Both the original 2D and Jacobson&#39;s version of the 3D Shepp-Logan phantom are also available in the ImagePhantoms.jl package. For higher precision, one might prefer ImagePhantoms.jl, which samples the analytical definition in Fourier or Randon space directly. GeometricMedicalPhantoms.jl, however, provides more flexibility over geometry and intensity customization, and have been optimized for fast voxel-based rendering.</p><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><h3 id="2D-Slices"><a class="docs-heading-anchor" href="#2D-Slices">2D Slices</a><a id="2D-Slices-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Slices" title="Permalink"></a></h3><p>Generate a 2D Shepp-Logan phantom at any orientation:</p><pre><code class="language-julia hljs"># Create axial (horizontal) slice
phantom_axial = create_shepp_logan_phantom(256, 256, :axial)
jim(phantom_axial; title=&quot;Axial View&quot;, clim=(0.95, 1.05), yflip=false)</code></pre><p><img src="../shepp_logan_axial.png" alt="shepp_logan_axial.png"/></p><pre><code class="language-julia hljs"># Create coronal (front-to-back) slice
phantom_coronal = create_shepp_logan_phantom(256, 256, :coronal)
jim(phantom_coronal; title=&quot;Coronal View&quot;, clim=(0.95, 1.05), yflip=false)</code></pre><p><img src="../shepp_logan_coronal.png" alt="shepp_logan_coronal.png"/></p><pre><code class="language-julia hljs"># Create sagittal (left-right) slice
phantom_sagittal = create_shepp_logan_phantom(256, 256, :sagittal)
jim(phantom_sagittal; title=&quot;Sagittal View&quot;, clim=(0.95, 1.05), yflip=false)</code></pre><p><img src="../shepp_logan_sagittal.png" alt="shepp_logan_sagittal.png"/></p><h3 id="3D-Volume"><a class="docs-heading-anchor" href="#3D-Volume">3D Volume</a><a id="3D-Volume-1"></a><a class="docs-heading-anchor-permalink" href="#3D-Volume" title="Permalink"></a></h3><p>Generate a full 3D phantom:</p><pre><code class="language-julia hljs">phantom_3d = create_shepp_logan_phantom(128, 128, 128)
println(&quot;Phantom shape: $(size(phantom_3d))&quot;)
println(&quot;Min value: $(minimum(phantom_3d))&quot;)
println(&quot;Max value: $(maximum(phantom_3d))&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phantom shape: (128, 128, 128)
Min value: 0.0
Max value: 2.0</code></pre><p>Create spatial slicing GIF showing all slices through the volume:</p><pre><code class="language-julia hljs">using FileIO, ImageIO, ImageMagick

# Create axial slices GIF (loop through z-axis)
nx, ny, nz = size(phantom_3d)
frames_axial = zeros(UInt8, nx, ny, nz)

for i in 1:nz
    slice = abs.(phantom_3d[:, :, i])
    frames_axial[:, :, i] = map(x -&gt; UInt8(round((clamp(x, 0.95, 1.05) - 0.95) / 0.1 * 255)), slice)
end

save(&quot;shepp_logan_axial_slices.gif&quot;, frames_axial, fps=10)</code></pre><p><img src="../shepp_logan_axial_slices.gif" alt="shepp_logan_axial_slices.gif"/></p><pre><code class="language-julia hljs"># Create coronal slices GIF (loop through y-axis)
frames_coronal = zeros(UInt8, nx, nz, ny)
for i in 1:ny
    slice = abs.(phantom_3d[:, i, :])
    frames_coronal[:, :, i] = map(x -&gt; UInt8(round((clamp(x, 0.95, 1.05) - 0.95) / 0.1 * 255)), slice)
end

save(&quot;shepp_logan_coronal_slices.gif&quot;, frames_coronal, fps=10)</code></pre><p><img src="../shepp_logan_coronal_slices.gif" alt="shepp_logan_coronal_slices.gif"/></p><pre><code class="language-julia hljs"># Create sagittal slices GIF (loop through x-axis)
frames_sagittal = zeros(UInt8, ny, nz, nx)
for i in 1:nx
    slice = abs.(phantom_3d[i, :, :])
    frames_sagittal[:, :, i] = map(x -&gt; UInt8(round((clamp(x, 0.95, 1.05) - 0.95) / 0.1 * 255)), slice)
end

save(&quot;shepp_logan_sagittal_slices.gif&quot;, frames_sagittal, fps=10)</code></pre><p><img src="../shepp_logan_sagittal_slices.gif" alt="shepp_logan_sagittal_slices.gif"/></p><h2 id="Intensity-Variants"><a class="docs-heading-anchor" href="#Intensity-Variants">Intensity Variants</a><a id="Intensity-Variants-1"></a><a class="docs-heading-anchor-permalink" href="#Intensity-Variants" title="Permalink"></a></h2><p>The package provides different intensity scaling options:</p><h3 id="CT-Intensities-(Original-Shepp-Logan)"><a class="docs-heading-anchor" href="#CT-Intensities-(Original-Shepp-Logan)">CT Intensities (Original Shepp-Logan)</a><a id="CT-Intensities-(Original-Shepp-Logan)-1"></a><a class="docs-heading-anchor-permalink" href="#CT-Intensities-(Original-Shepp-Logan)" title="Permalink"></a></h3><pre><code class="language-julia hljs">phantom_ct = create_shepp_logan_phantom(256, 256, :axial; ti=CTSheppLoganIntensities())
jim(phantom_ct; title=&quot;CT Shepp-Logan&quot;, clim=(0.95, 1.05), yflip=false)</code></pre><p><img src="../shepp_logan_ct.png" alt="shepp_logan_ct.png"/></p><p>This uses the original Shepp &amp; Logan (1974) attenuation coefficients adapted for CT imaging.</p><h3 id="MRI-Intensities-(Toft-1996)"><a class="docs-heading-anchor" href="#MRI-Intensities-(Toft-1996)">MRI Intensities (Toft 1996)</a><a id="MRI-Intensities-(Toft-1996)-1"></a><a class="docs-heading-anchor-permalink" href="#MRI-Intensities-(Toft-1996)" title="Permalink"></a></h3><pre><code class="language-julia hljs">phantom_mri = create_shepp_logan_phantom(256, 256, :axial; ti=MRISheppLoganIntensities())
jim(phantom_mri; title=&quot;MRI Shepp-Logan&quot;, yflip=false)</code></pre><p><img src="../shepp_logan_mri.png" alt="shepp_logan_mri.png"/></p><p>The MRI version from Toft&#39;s PhD thesis (1996) provides intensity values suited for nuclear magnetic resonance imaging.</p><h3 id="Custom-Intensities"><a class="docs-heading-anchor" href="#Custom-Intensities">Custom Intensities</a><a id="Custom-Intensities-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Intensities" title="Permalink"></a></h3><p>You can create custom intensity values:</p><pre><code class="language-julia hljs">using GeometricMedicalPhantoms: SheppLoganIntensities

# Create custom intensities with your own values
custom_intensities = SheppLoganIntensities(
    skull=1.5,
    brain=0.5,
    right_big=-0.1,
    left_big=-0.1,
    top=0.2,
    middle_high=0.2,
    bottom_left=0.2,
    middle_low=0.2,
    bottom_center=0.2,
    bottom_right=0.2,
    extra_1=0.3,
    extra_2=-0.1
)

phantom_custom = create_shepp_logan_phantom(256, 256, :axial; ti=custom_intensities)
jim(phantom_custom; title=&quot;Custom Intensities&quot;, yflip=false)</code></pre><p><img src="../shepp_logan_custom.png" alt="shepp_logan_custom.png"/></p><h2 id="Tissue-Masking"><a class="docs-heading-anchor" href="#Tissue-Masking">Tissue Masking</a><a id="Tissue-Masking-1"></a><a class="docs-heading-anchor-permalink" href="#Tissue-Masking" title="Permalink"></a></h2><p>Extract masks for specific anatomical regions:</p><pre><code class="language-julia hljs"># Create mask of the skull
skull_mask = create_shepp_logan_phantom(256, 256, :axial; ti=SheppLoganMask(skull=true))
jim(skull_mask; title=&quot;Skull Mask&quot;, yflip=false)</code></pre><p><img src="../shepp_logan_skull_mask.png" alt="shepp_logan_skull_mask.png"/></p><pre><code class="language-julia hljs"># Create mask of the brain
brain_mask = create_shepp_logan_phantom(256, 256, :axial; ti=SheppLoganMask(brain=true))
jim(brain_mask; title=&quot;Brain Mask&quot;, yflip=false)</code></pre><p><img src="../shepp_logan_brain_mask.png" alt="shepp_logan_brain_mask.png"/></p><pre><code class="language-julia hljs"># Create combined mask of brain structures
structures_mask = create_shepp_logan_phantom(256, 256, :axial;
    ti=SheppLoganMask(brain=true, right_big=true, left_big=true))
jim(structures_mask; title=&quot;Brain Structures&quot;, yflip=false)</code></pre><p><img src="../shepp_logan_structures_mask.png" alt="shepp_logan_structures_mask.png"/></p><h2 id="Advanced-Parameters"><a class="docs-heading-anchor" href="#Advanced-Parameters">Advanced Parameters</a><a id="Advanced-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Parameters" title="Permalink"></a></h2><h3 id="Resolution-and-Field-of-View"><a class="docs-heading-anchor" href="#Resolution-and-Field-of-View">Resolution and Field of View</a><a id="Resolution-and-Field-of-View-1"></a><a class="docs-heading-anchor-permalink" href="#Resolution-and-Field-of-View" title="Permalink"></a></h3><p>Control the resolution and spatial extent:</p><pre><code class="language-julia hljs"># Low resolution
phantom_low = create_shepp_logan_phantom(64, 64, :axial)

# High resolution
phantom_high = create_shepp_logan_phantom(512, 512, :axial)

p1 = jim(phantom_low; title=&quot;Low Res (64×64)&quot;, clim=(0.95, 1.05), yflip=false)
p2 = jim(phantom_high; title=&quot;High Res (512×512)&quot;, clim=(0.95, 1.05), yflip=false)
plot(p1, p2, layout=(1,2), size=(1000,400))</code></pre><p><img src="../shepp_logan_resolution.png" alt="shepp_logan_resolution.png"/></p><h3 id="Custom-Field-of-View"><a class="docs-heading-anchor" href="#Custom-Field-of-View">Custom Field of View</a><a id="Custom-Field-of-View-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Field-of-View" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Smaller FOV (zoomed in)
phantom_small_fov = create_shepp_logan_phantom(256, 256, :axial; fovs=(10.0, 10.0))

# Larger FOV (zoomed out)
phantom_large_fov = create_shepp_logan_phantom(256, 256, :axial; fovs=(30.0, 30.0))

p1 = jim(phantom_small_fov; title=&quot;Small FOV (10cm)&quot;, clim=(0.95, 1.05), yflip=false)
p2 = jim(phantom_large_fov; title=&quot;Large FOV (30cm)&quot;, clim=(0.95, 1.05), yflip=false)
plot(p1, p2, layout=(1,2), size=(1000,400))</code></pre><p><img src="../shepp_logan_fov.png" alt="shepp_logan_fov.png"/></p><h3 id="Data-Type"><a class="docs-heading-anchor" href="#Data-Type">Data Type</a><a id="Data-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Type" title="Permalink"></a></h3><p>Control the output data type and create specific masks:</p><pre><code class="language-julia hljs">phantom_f32 = create_shepp_logan_phantom(256, 256, :axial; eltype=Float32)
phantom_f64 = create_shepp_logan_phantom(256, 256, :axial; eltype=Float64)
# Create a mask where only skull and top ellipsoids are selected
phantom_mask = create_shepp_logan_phantom(256, 256, :axial; ti=SheppLoganMask(skull=true, top=true))

println(&quot;Float32: $(typeof(phantom_f32))&quot;)
println(&quot;Float64: $(typeof(phantom_f64))&quot;)
println(&quot;Mask (Bool): $(typeof(phantom_mask))&quot;)

jim(phantom_mask; title=&quot;Skull + Top Mask&quot;, yflip=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Float32: Matrix{Float32}
Float64: Matrix{Float64}
Mask (Bool): BitMatrix</code></pre><p><img src="../shepp_logan_mask_example.png" alt="shepp_logan_mask_example.png"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../torso/">Torso Phantom »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 16 February 2026 15:15">Monday 16 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
