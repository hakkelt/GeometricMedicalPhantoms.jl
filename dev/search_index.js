var documenterSearchIndex = {"docs":
[{"location":"api/#API-Reference","page":"API Reference","title":"API Reference","text":"Complete reference for all public functions and types in GeometricMedicalPhantoms.","category":"section"},{"location":"api/#Shepp-Logan-Phantom","page":"API Reference","title":"Shepp-Logan Phantom","text":"Everything related to the Shepp-Logan phantom.","category":"section"},{"location":"api/#Torso-Phantom","page":"API Reference","title":"Torso Phantom","text":"Everything related to the Torso phantom, including physiological motion.","category":"section"},{"location":"api/#Tubes-Phantom","page":"API Reference","title":"Tubes Phantom","text":"Everything related to the Tubes phantom.","category":"section"},{"location":"api/#Geometric-Primitives","page":"API Reference","title":"Geometric Primitives","text":"Building blocks for custom phantoms.","category":"section"},{"location":"api/#Ellipsoids","page":"API Reference","title":"Ellipsoids","text":"","category":"section"},{"location":"api/#Cylinders","page":"API Reference","title":"Cylinders","text":"","category":"section"},{"location":"api/#GeometricMedicalPhantoms.create_shepp_logan_phantom","page":"API Reference","title":"GeometricMedicalPhantoms.create_shepp_logan_phantom","text":"create_shepp_logan_phantom(nx, ny, nz; fovs=(20,20,20), ti=CTSheppLoganIntensities(), eltype=Float32)\ncreate_shepp_logan_phantom(nx, ny, axis; fovs=(20,20), slice_position=0.0, ti=CTSheppLoganIntensities(), eltype=Float32)\n\nGenerate a 3D Shepp-Logan phantom or a 2D slice of it.\n\nFor a 2D slice, provide nx, ny, and an axis (:axial, :coronal, :sagittal). The slice_position determines where the slice is taken. The intensities ti can be specified using CTSheppLoganIntensities() (default) or MRISheppLoganIntensities().\n\nAttribution\n\nThe geometry and intensity definitions are based on [1, 2, 3, 4].\n\nReferences\n\n[1] L. A. Shepp and B. F. Logan, “The Fourier reconstruction of a head section,” IEEE Trans. Nucl. Sci., 1974. [2] L. A. Shepp, “Computerized tomography and nuclear magnetic resonance,” 1980. [3] P. A. Toft, “The Radon Transform - Theory and Implementation,” PhD Thesis, 1996. [4] A. C. Kak and M. Slaney, Principles of Computerized Tomographic Imaging. IEEE Press, 1988.\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.CTSheppLoganIntensities","page":"API Reference","title":"GeometricMedicalPhantoms.CTSheppLoganIntensities","text":"CTSheppLoganIntensities()\n\nCreate a SheppLoganIntensities object with original CT version values.\n\nAttribution\n\nThe intensities are fetched from the original paper [1].\n\nReferences\n\n[1] L. A. Shepp and B. F. Logan, “The Fourier reconstruction of a head section,” IEEE Trans. Nucl. Sci., vol. 21, no. 3, pp. 21–43, Jun. 1974, doi: 10.1109/TNS.1974.6499235.\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.MRISheppLoganIntensities","page":"API Reference","title":"GeometricMedicalPhantoms.MRISheppLoganIntensities","text":"MRISheppLoganIntensities()\n\nCreate a SheppLoganIntensities object with MRI (Toft's) version values.\n\nAttribution\n\nThe intensities are from the PhD thesis of Peter Aundal Toft [1].\n\nReferences\n\n[1] P. A. Toft, “The Radon Transform - Theory and Implementation,” PhD Thesis, Technical University of Denmark, Kgs. Lyngby, Denmark, 1996. [Online]. Available: https://orbit.dtu.dk/files/5529668/Binder1.pdf\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.SheppLoganIntensities","page":"API Reference","title":"GeometricMedicalPhantoms.SheppLoganIntensities","text":"SheppLoganIntensities{T}\n\nStruct to hold intensity values for the 12 ellipsoids in a 3D Shepp-Logan phantom. For 2D phantoms, only the first 10 values are typically used.\n\nFields:\n\nskull: Intensity of the skull.\nbrain: Intensity of the brain.\nright_big: Intensity of the right big ellipsoid.\nleft_big: Intensity of the left big ellipsoid.\ntop: Intensity of the top ellipsoid.\nmiddle_high: Intensity of the middle high ellipsoid.\nbottom_left: Intensity of the bottom left ellipsoid.\nmiddle_low: Intensity of the middle low ellipsoid.\nbottom_center: Intensity of the bottom center ellipsoid.\nbottom_right: Intensity of the bottom right ellipsoid.\nextra_1: Intensity of the extra 1 ellipsoid.\nextra_2: Intensity of the extra 2 ellipsoid.\n\nNote: All intensities are additive values, so the total intensity at a given point is the sum of the intensities of all ellipsoids that contain that point.\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.SheppLoganMask","page":"API Reference","title":"GeometricMedicalPhantoms.SheppLoganMask","text":"SheppLoganMask(; kwargs...)\n\nCreate a SheppLoganIntensities{Bool} object for masking specific ellipsoids. Defaults to all false. Use keyword arguments to set specific ellipsoids to true.\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.create_torso_phantom","page":"API Reference","title":"GeometricMedicalPhantoms.create_torso_phantom","text":"create_torso_phantom(nx::Int, ny::Int, axis::Symbol; fovs=(30, 30), slice_position=0.0, eltype=Float32) -> Array{eltype, 3}\n\nGenerate a 2D slice of a torso phantom with anatomical structures.\n\nArguments\n\nnx::Int: Number of voxels in first dimension\nny::Int: Number of voxels in second dimension  \naxis::Symbol: Slice orientation - :axial, :coronal, or :sagittal\n\nKeywords\n\nfovs::Tuple=(30, 30): Field of view in cm for (x, y) directions\nslice_position::Real=0.0: Position of the slice in cm (in the third dimension)\nrespiratory_signal::Union{Nothing,AbstractVector}=nothing: Respiratory signal in liters for time-varying phantom\ncardiac_volumes::Union{Nothing,NamedTuple}=nothing: Cardiac volumes in mL for time-varying phantom; must have fields :lv, :rv, :la, :ra\nti::AbstractTissueParameters=TissueIntensities(): Tissue parameters (TissueIntensities or TissueMask)\neltype=Float32: Element type for the generated phantom array\n\nReturns\n\nArray{eltype, 3}: 3D phantom array with size (nx, ny, nt) where nt is the number of time frames. Returns BitArray when TissueMask is passed.\n\nDescription\n\nCreates a 2D slice through the 3D torso phantom. The slice orientation is determined by the axis parameter:\n\n:axial: Horizontal slice (x-y plane), controlled by z-position\n:coronal: Front-to-back slice (x-z plane), controlled by y-position  \n:sagittal: Side-to-side slice (y-z plane), controlled by x-position\n\nExample\n\n# Axial slice at heart level (z=0)\nphantom_axial = create_torso_phantom(128, 128, :axial)\n\n# Coronal slice through center\nphantom_coronal = create_torso_phantom(128, 128, :coronal; slice_position=0.0)\n\n# Sagittal slice, right of center\nphantom_sagittal = create_torso_phantom(128, 128, :sagittal; slice_position=5.0)\n\n\n\n\n\ncreate_torso_phantom(nx::Int=128, ny::Int=128, nz::Int=128; fovs=(30, 30, 30), eltype=Float32) -> Array{eltype, 4}\n\nGenerate a 3D torso phantom with anatomical structures including torso outline, lungs, heart, and vessels.\n\nArguments\n\nnx::Int=128: Number of voxels in x-direction\nny::Int=128: Number of voxels in y-direction  \nnz::Int=128: Number of voxels in z-direction\n\nKeywords\n\nfovs::Tuple=(30, 30, 30): Field of view in cm for (x, y, z) directions\nrespiratory_signal::Union{Nothing,AbstractVector}=nothing: Respiratory signal in liters for 4D phantom generation\ncardiac_volumes::Union{Nothing,NamedTuple}=nothing: Cardiac volumes in mL for 4D phantom generation; must have fields :lv, :rv, :la, :ra\nti::AbstractTissueParameters=TissueIntensities(): Tissue parameters (TissueIntensities or TissueMask) for different structures\neltype=Float32: Element type for the generated phantom array (Float32, Float64, ComplexF32, ComplexF64, etc.). When TissueMask is passed, returns BitArray regardless of eltype.\n\nReturns\n\nArray{eltype, 4}: 4D phantom array with size (nx, ny, nz, nt) where nt is the number of time frames. Returns BitArray when TissueMask is passed.\n\nDescription\n\nCreates a simplified anatomical torso phantom with the following structures:\n\nTorso: Multi-segment outer boundary (upper/middle/lower) for realistic shape\nLungs: Multiple ellipsoids representing left/right lung lobes\nHeart: Multiple ellipsoids for ventricles and atria\nVessels: Aorta, pulmonary artery, and superior vena cava\nSpine: Vertebral column with 12 vertebrae\nRibs: Paired rib structures arranged in 9 levels\nLiver and Stomach: Basic ellipsoidal shapes in the abdomen\n\nExample\n\nphantom = create_torso_phantom(128, 128, 128)  # Float32\nphantom_f64 = create_torso_phantom(128, 128, 128; eltype=Float64)\nphantom_complex = create_torso_phantom(128, 128, 128; eltype=ComplexF32)\n\n# Create binary mask for lung tissue\nlung_mask = TissueMask(lung=true)\nphantom_mask = create_torso_phantom(128, 128, 128; ti=lung_mask)  # BitArray\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.TissueIntensities","page":"API Reference","title":"GeometricMedicalPhantoms.TissueIntensities","text":"TissueIntensities <: AbstractTissueParameters\n\nStruct to hold tissue intensity values for different anatomical structures in the torso phantom.\n\nFields:\n\nlung::Float64: Intensity value for lung tissue\nheart::Float64: Intensity value for heart muscle\nvessels_blood::Float64: Intensity value for blood in vessels\nbones::Float64: Intensity value for bone tissue\nliver::Float64: Intensity value for liver tissue\nstomach::Float64: Intensity value for stomach tissue\nbody::Float64: Intensity value for general body tissue\nlv_blood::Float64: Intensity value for left ventricle blood\nrv_blood::Float64: Intensity value for right ventricle blood\nla_blood::Float64: Intensity value for left atrium blood\nra_blood::Float64: Intensity value for right atrium blood\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.TissueMask","page":"API Reference","title":"GeometricMedicalPhantoms.TissueMask","text":"TissueMask <: AbstractTissueParameters\n\nStruct to hold tissue mask specification for binary phantom generation. Only one tissue type should be selected (set to true), all others should be false.\n\nFields:\n\nlung::Bool: Whether to include lung tissue\nheart::Bool: Whether to include heart muscle\nvessels_blood::Bool: Whether to include blood in vessels\nbones::Bool: Whether to include bone tissue\nliver::Bool: Whether to include liver tissue\nstomach::Bool: Whether to include stomach tissue\nbody::Bool: Whether to include general body tissue\nlv_blood::Bool: Whether to include left ventricle blood\nrv_blood::Bool: Whether to include right ventricle blood\nla_blood::Bool: Whether to include left atrium blood\nra_blood::Bool: Whether to include right atrium blood\n\nExample\n\n# Create a mask for lung tissue only\nlung_mask = TissueMask(lung=true)\n\n# Create a mask for heart muscle only\nheart_mask = TissueMask(heart=true)\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.RespiratoryPhysiology","page":"API Reference","title":"GeometricMedicalPhantoms.RespiratoryPhysiology","text":"RespiratoryPhysiology\n\nPhysiology constants controlling simulated respiratory signal (liters).\n\nFields\n\nminL, maxL: Minimum and maximum lung volume in liters\nasym_amp: Amplitude of asymmetry harmonic (fraction of main amplitude)\namp_mod_amp, amp_mod_freq: Amplitude modulation amplitude (fraction) and frequency (Hz)\nrr_var_amp, rr_var_freq: Respiratory rate variability amplitude (fraction of base) and frequency (Hz)\n\nUsage Create with keyword overrides and pass as physiology to generate_respiratory_signal.\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.generate_respiratory_signal","page":"API Reference","title":"GeometricMedicalPhantoms.generate_respiratory_signal","text":"generate_respiratory_signal(duration=60.0, fs=50.0, rr=15.0; physiology::RespiratoryPhysiology=RespiratoryPhysiology()) -> (Vector{Float64}, Vector{Float64})\n\nGenerate a simplified respiratory signal in liters.\n\nArguments\n\nduration::Float64=60.0: Duration of signal in seconds\nfs::Float64=50.0: Sampling frequency in Hz\nrr::Float64=15.0: Respiratory rate in breaths per minute\nphysiology::RespiratoryPhysiology=RespiratoryPhysiology(): Optional physiology constants\n\nReturns\n\nTuple of (timevector, respiratorysignal_liters)\n\nDescription\n\nGenerates a synthetic respiratory signal with:\n\nSinusoidal breathing pattern\nAsymmetric inspiration/expiration\nAmplitude modulation (breathing depth variation)\n\nExample\n\nt, resp_L = generate_respiratory_signal(60.0, 50.0, 15.0)\n# resp_L is in liters\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.CardiacPhysiology","page":"API Reference","title":"GeometricMedicalPhantoms.CardiacPhysiology","text":"CardiacPhysiology\n\nPhysiology constants controlling simulated cardiac chamber volumes (mL) and slow modulations.\n\nFields\n\nlv_edv: Left ventricle end-diastolic volume (mL)\nlv_esv: Left ventricle end-systolic volume (mL)\nrv_edv: Right ventricle end-diastolic volume (mL)\nrv_esv: Right ventricle end-systolic volume (mL)\nla_min, la_max: Left atrium min/max volumes (mL)\nra_min, ra_max: Right atrium min/max volumes (mL)\nhr_var_amp, hr_var_freq: Heart rate variability amplitude (fraction) and frequency (Hz)\nv_amp_amp, v_amp_freq: Ventricular amplitude modulation amplitude (fraction) and frequency (Hz)\na_amp_amp, a_amp_freq: Atrial amplitude modulation amplitude (fraction) and frequency (Hz)\nbw_amp, bw_freq: Baseline wander amplitude (mL) and frequency (Hz)\ns_frac_base: Base systole fraction (0..1)\nlv_kick_amp_frac, lv_kick_center, lv_kick_width: Left ventricle atrial kick amplitude fraction, center, and width\nrv_kick_amp_frac, rv_kick_center, rv_kick_width: Right ventricle atrial kick amplitude fraction, center, and width\nla_contr_amp_frac, la_contr_center, la_contr_width: Left atrium contraction amplitude fraction, center, and width\nra_contr_amp_frac, ra_contr_center, ra_contr_width: Right atrium contraction amplitude fraction, center, and width\n\nUsage Create with keyword overrides and pass as physiology to generate_cardiac_signals to customize volumes and modulations.\n\nExample\n\nphys = CardiacPhysiology(lv_edv=130.0, lv_esv=55.0, rv_edv=140.0, rv_esv=65.0)\nt, vols = generate_cardiac_signals(10.0, 500.0, 70.0; physiology=phys)\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.generate_cardiac_signals","page":"API Reference","title":"GeometricMedicalPhantoms.generate_cardiac_signals","text":"generate_cardiac_signals(duration=10.0, fs=500.0, hr=70.0; physiology::CardiacPhysiology=CardiacPhysiology()) -> (Vector{Float64}, NamedTuple)\n\nSimulate cardiac chamber volumes (mL) for left/right ventricles and atria.\n\nArguments\n\nduration::Float64=10.0: Duration of signal in seconds\nfs::Float64=500.0: Sampling frequency in Hz\nhr::Float64=70.0: Heart rate in beats per minute\nphysiology::CardiacPhysiology=CardiacPhysiology(): Optional physiology constants\n\nReturns\n\nTuple of (time_vector, volumes::NamedTuple{(:lv,:rv,:la,:ra)}) where each field is Vector{Float64}\n\nDescription\n\nGenerates four periodic time series of chamber volumes in milliliters.\nThe ventricles are high during diastole and low during systole; atria are approximately in opposite phase.\nDefault physiology constants are set to plausible values but can be tuned via physiology.\nIt includes slight heart rate variability, amplitude modulation, and baseline wander.\n\nExample\n\nt, vols = generate_cardiac_signals(10.0, 500.0, 70.0)\n# vols.lv, vols.rv, vols.la, vols.ra are in mL\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.create_tubes_phantom","page":"API Reference","title":"GeometricMedicalPhantoms.create_tubes_phantom","text":"create_tubes_phantom(nx::Int, ny::Int, nz::Int; kwargs...)\ncreate_tubes_phantom(nx::Int, ny::Int, axis::Symbol; kwargs...)\n\nGenerate a tubes phantom. When invoked with three dimensions, a 3D volume is returned; when invoked with an axis symbol, a 2D slice is produced. In both modes the ti keyword accepts either a single TubesIntensities or a vector of intensities to render a stack of frames (resulting in a 4D volume or 3D stack, respectively).\n\nArguments\n\nnx::Int: Number of voxels in the x direction\nny::Int: Number of voxels in the y direction\nnz::Int: Number of voxels in the z direction (only for volume mode)\naxis::Symbol: Slice orientation (:axial, :coronal, or :sagittal)\n\nKeyword Arguments\n\nfovs::Tuple{Real,Real,Real}: Field of view in cm for volume mode (default: (10.0, 10.0, 10.0))\nfovs::Tuple{Real,Real}: Field of view in cm for slice mode (default: (10.0, 10.0))\nslice_position::Real: Position along the perpendicular axis in cm (default: 0.0, slice mode only)\ntg::TubesGeometry: Geometry parameters (default: TubesGeometry())\nti::Union{TubesIntensities, Vector{<:TubesIntensities}}: Either a single intensity set or a collection of intensity sets to produce multiple frames (default: TubesIntensities())\neltype::Type: Element type for the phantom array (default: Float32)\n\nReturns\n\nVolume mode: Array{eltype,3} for single intensity or Array{eltype,4} when a vector of intensities is provided\nSlice mode: Array{eltype,2} for single intensity or Array{eltype,3} when multiple intensities are passed\n\nExamples\n\nphantom3d = create_tubes_phantom(128, 128, 128)\nphantom_stack = create_tubes_phantom(128, 128, 128; ti=[TubesIntensities(), TubesIntensities(tube_fillings=[0.2])])\nphantom_axial = create_tubes_phantom(128, 128, :axial; slice_position=2.0)\nphantom_axial_stack = create_tubes_phantom(128, 128, :axial; ti=[TubesIntensities(), TubesIntensities(tube_fillings=[0.8])])\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.TubesGeometry","page":"API Reference","title":"GeometricMedicalPhantoms.TubesGeometry","text":"TubesGeometry\n\nGeometry parameters for the tubes phantom.\n\nFields\n\nouter_radius::Float64: Radius of the outer cylinder\nouter_height::Float64: Height of the outer cylinder\ntube_wall_thickness::Float64: Thickness of tube walls\ngap_fraction::Float64: Fraction of space between tubes\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.TubesIntensities","page":"API Reference","title":"GeometricMedicalPhantoms.TubesIntensities","text":"TubesIntensities\n\nIntensity parameters for the tubes phantom.\n\nFields\n\nouter_cylinder::Float64: Intensity of the outer cylinder (default: 0.25)\ntube_wall::Float64: Intensity of tube walls (default: 0.0)\ntube_fillings::Vector{Float64}: Intensities for tube fillings (default: [0.1, 0.3, 0.5, 0.7, 0.9, 1.0])\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.TubesMask","page":"API Reference","title":"GeometricMedicalPhantoms.TubesMask","text":"TubesMask(; kwargs...)\n\nCreate a boolean mask for the tubes phantom.\n\nExample\n\nmask = TubesMask(outer_cylinder=true, tube_wall=false, tube_fillings=[true, true, true, true, true, true])\n\n\n\n\n\n","category":"function"},{"location":"api/#GeometricMedicalPhantoms.Ellipsoid","page":"API Reference","title":"GeometricMedicalPhantoms.Ellipsoid","text":"Ellipsoid\n\nStruct to store the parameters of an ellipsoid.\n\nThe points (x, y, z) inside the ellipsoid satisfy the equation:     (fracx - cxrx)^2 + (fracy - cyry)^2 + (fracz - czrz)^2 leq 1\n\nFields:\n\ncx::Real: X-coordinate of the center\ncy::Real: Y-coordinate of the center\ncz::Real: Z-coordinate of the center\nrx::Real: Radius in x-direction\nry::Real: Radius in y-direction\nrz::Real: Radius in z-direction\nintensity::Real: Intensity value for the ellipsoid\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.SuperEllipsoid","page":"API Reference","title":"GeometricMedicalPhantoms.SuperEllipsoid","text":"SuperEllipsoid\n\nStruct to store the parameters of a superellipsoid.\n\nThe points (x, y, z) inside the superellipsoid satisfy the equation:\n\n``(\\frac{|x - cx|}{rx})^{ex[1]} + (\\frac{|y - cy|}{ry})^{ex[2]} + (\\frac{|z - cz|}{rz})^{ex[3]} \\leq 1``\n\nFields:\n\ncx::Real: X-coordinate of the center\ncy::Real: Y-coordinate of the center\ncz::Real: Z-coordinate of the center\nrx::Real: Radius in x-direction\nry::Real: Radius in y-direction\nrz::Real: Radius in z-direction\nex::NTuple{3,Real}: Exponents for (x, y, z) directions\nintensity::Real: Intensity value for the superellipsoid\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.RotatedEllipsoid","page":"API Reference","title":"GeometricMedicalPhantoms.RotatedEllipsoid","text":"RotatedEllipsoid\n\nStruct to store the parameters of a rotated ellipsoid.\n\nThe points (x, y, z) inside the ellipsoid satisfy the equation:     (R^-1 (P - C))^T D (R^-1 (P - C)) leq 1 where R is the rotation matrix (Z-Y-X order), C is the center, and D is the diagonal matrix of inverse radii squared.\n\nFields:\n\ncx, cy, cz::Real: Center coordinates\nrx, ry, rz::Real: Radii\nphi, theta, psi::Real: Rotation angles in radians (Z-Y-X order)\nintensity::Real: Intensity value\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.CylinderX","page":"API Reference","title":"GeometricMedicalPhantoms.CylinderX","text":"CylinderX\n\nStruct to store the parameters of a cylinder aligned along the x-axis.\n\nA cylinder is defined by its center (cx, cy, cz), radius, and height. The cylinder is aligned along the x-axis and extends from cx - height/2 to cx + height/2.\n\nThe points (x, y, z) inside the cylinder satisfy the inequalities:     sqrt(y - cy)^2 + (z - cz)^2 leq r and x - cx leq textheight2\n\nFields:\n\ncx::Real: X-coordinate of the center\ncy::Real: Y-coordinate of the center\ncz::Real: Z-coordinate of the center\nr::Real: Radius of the cylinder\nheight::Real: Height of the cylinder along the x-axis\nintensity::Real: Intensity value for the cylinder\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.CylinderY","page":"API Reference","title":"GeometricMedicalPhantoms.CylinderY","text":"CylinderY\n\nStruct to store the parameters of a cylinder aligned along the y-axis.\n\nA cylinder is defined by its center (cx, cy, cz), radius, and height. The cylinder is aligned along the y-axis and extends from cy - height/2 to cy + height/2.\n\nThe points (x, y, z) inside the cylinder satisfy the inequalities:     sqrt(x - cx)^2 + (z - cz)^2 leq r and y - cy leq textheight2\n\nFields:\n\ncx::Real: X-coordinate of the center\ncy::Real: Y-coordinate of the center\ncz::Real: Z-coordinate of the center\nr::Real: Radius of the cylinder\nheight::Real: Height of the cylinder along the y-axis\nintensity::Real: Intensity value for the cylinder\n\n\n\n\n\n","category":"type"},{"location":"api/#GeometricMedicalPhantoms.CylinderZ","page":"API Reference","title":"GeometricMedicalPhantoms.CylinderZ","text":"CylinderZ\n\nStruct to store the parameters of a cylinder aligned along the z-axis.\n\nA cylinder is defined by its center (cx, cy, cz), radius, and height. The cylinder is aligned along the z-axis and extends from cz - height/2 to cz + height/2.\n\nThe points (x, y, z) inside the cylinder satisfy the inequalities:     sqrt(x - cx)^2 + (y - cy)^2 leq r and z - cz leq textheight2\n\nFields:\n\ncx::Real: X-coordinate of the center\ncy::Real: Y-coordinate of the center\ncz::Real: Z-coordinate of the center\nr::Real: Radius of the cylinder\nheight::Real: Height of the cylinder along the z-axis\nintensity::Real: Intensity value for the cylinder\n\n\n\n\n\n","category":"type"},{"location":"advanced/custom_phantoms/#Building-Custom-Phantoms","page":"Custom Phantoms","title":"Building Custom Phantoms","text":"This guide shows how to create new phantom types from scratch using the geometric primitives provided by GeometricMedicalPhantoms. We'll walk through the key concepts and build a complete example.","category":"section"},{"location":"advanced/custom_phantoms/#Overview:-From-Primitives-to-Phantoms","page":"Custom Phantoms","title":"Overview: From Primitives to Phantoms","text":"Every phantom in GeometricMedicalPhantoms follows the same pattern:\n\nDefine geometry: Create an array of geometric primitives (ellipsoids, cylinders, etc.)\nDefine intensities: Create a structure specifying how to assign intensities to tissues\nCreate parameters: Build a function to generate these based on user input\nRender: Call the internal rendering function to create the phantom","category":"section"},{"location":"advanced/custom_phantoms/#Intensity-Assignment:-Additive-vs.-Masking","page":"Custom Phantoms","title":"Intensity Assignment: Additive vs. Masking","text":"When primitives overlap, their intensities combine according to one of two modes:","category":"section"},{"location":"advanced/custom_phantoms/#Additive-Mode","page":"Custom Phantoms","title":"Additive Mode","text":"Intensities add together. If two primitives overlap at a point, the result is the sum of both intensities (or maximum, depending on implementation):\n\n# Pseudo-code\nfor point in phantom\n    intensity = 0\n    for primitive in primitives\n        if point_in_primitive(point, primitive)\n            intensity += primitive.intensity\n        end\n    end\nend\n\nUse when: Creating phantoms where structures have distinct tissue types that don't overlap (e.g., Shepp-Logan brain).","category":"section"},{"location":"advanced/custom_phantoms/#Masking-Mode","page":"Custom Phantoms","title":"Masking Mode","text":"Later primitives overwrite earlier ones. Order matters:\n\n# Pseudo-code\nfor point in phantom\n    intensity = 0\n    for primitive in primitives\n        if point_in_primitive(point, primitive)\n            intensity = primitive.intensity  # Overwrite\n        end\n    end\nend\n\nUse when: Creating composites where you want inner structures to override outer ones (e.g., heart chambers inside the torso, blood vessels overriding tissue).","category":"section"},{"location":"advanced/custom_phantoms/#Combining-Primitives","page":"Custom Phantoms","title":"Combining Primitives","text":"Complex phantoms are created by combining multiple primitives. The order and intensity assignment mode (Additive vs. Masking) determine the final result.\n\n# Combine ellipsoid and cylinder\n# Note: Constructors use positional arguments (cx, cy, cz, rx, ry, rz, intensity)\ncombined_shapes = [\n    Ellipsoid(0.0, 0.0, 0.0, 0.7, 0.6, 0.5, 0.5),\n    CylinderZ(0.0, 0.0, 0.0, 0.2, 1.5, 0.9)\n]\n\n# When using draw!, the order in the array matters for Masking primitives.\n# Additive primitives sum up.\nnothing # hide","category":"section"},{"location":"advanced/custom_phantoms/#Example:-Building-a-Simple-Brain-Phantom","page":"Custom Phantoms","title":"Example: Building a Simple Brain Phantom","text":"Let's create a minimal custom phantom showing a brain with ventricles and a tumor. This example follows the pattern used in the package's built-in phantoms.","category":"section"},{"location":"advanced/custom_phantoms/#Step-1:-Define-Geometry-Structure","page":"Custom Phantoms","title":"Step 1: Define Geometry Structure","text":"First, define the geometry parameters and a function that generates the shapes:\n\n# Custom geometry structure for our brain phantom\nstruct SimpleBrainGeometry\n    brain_radius::Float32      # Radius of brain ellipsoid\n    ventricle_radius::Float32  # Central ventricles\n    tumor_radius::Float32      # Lesion/tumor size\n    tumor_position::NTuple{3, Float32}  # (x, y, z) position\nend\n\n# Default constructor\nSimpleBrainGeometry() = SimpleBrainGeometry(0.8f0, 0.15f0, 0.1f0, (0.3f0, 0.2f0, 0.0f0))\n\n# Function that generates the list of shapes\nfunction get_brain_shapes(geom::SimpleBrainGeometry, intensities)\n    shapes = []\n    \n    # Brain ellipsoid (outermost) - using MaskingIntensityValue for masking mode\n    push!(shapes, Ellipsoid(\n        0.0f0, 0.0f0, 0.0f0,  # center\n        geom.brain_radius, geom.brain_radius * 1.1f0, geom.brain_radius * 0.9f0,  # radii\n        GeometricMedicalPhantoms.MaskingIntensityValue(Float32(intensities.brain))  # wrapped intensity\n    ))\n    \n    # Ventricles (overwrites brain interior)\n    push!(shapes, Ellipsoid(\n        0.0f0, 0.0f0, 0.0f0,\n        geom.ventricle_radius, geom.ventricle_radius * 1.5f0, geom.ventricle_radius * 2f0,\n        GeometricMedicalPhantoms.MaskingIntensityValue(Float32(intensities.ventricles))\n    ))\n    \n    # Tumor (overwrites everything at its location)\n    tx, ty, tz = geom.tumor_position\n    push!(shapes, Ellipsoid(\n        tx, ty, tz,\n        geom.tumor_radius * 1.2f0, geom.tumor_radius * 1.0f0, geom.tumor_radius * 0.8f0,\n        GeometricMedicalPhantoms.MaskingIntensityValue(Float32(intensities.tumor))\n    ))\n    \n    return shapes\nend\nnothing # hide","category":"section"},{"location":"advanced/custom_phantoms/#Step-2:-Define-Intensity-Structure","page":"Custom Phantoms","title":"Step 2: Define Intensity Structure","text":"This struct holds intensity values. We also define helper functions for both numeric and boolean (mask) intensities:\n\n# Numeric intensities\nstruct SimpleBrainIntensities\n    brain::Float32\n    ventricles::Float32\n    tumor::Float32\nend\n\n# Default constructor\nSimpleBrainIntensities() = SimpleBrainIntensities(0.6f0, 0.9f0, 1.0f0)\n\n# Helper function to get intensity by name (for numeric)\nfunction get_intensity(intensities::SimpleBrainIntensities, tissue::Symbol)\n    if tissue == :brain\n        return intensities.brain\n    elseif tissue == :ventricles\n        return intensities.ventricles\n    elseif tissue == :tumor\n        return intensities.tumor\n    else\n        return 0.0f0\n    end\nend\n\n# Boolean mask structure\nstruct SimpleBrainMask\n    brain::Bool\n    ventricles::Bool\n    tumor::Bool\nend\n\n# Default: all false\nSimpleBrainMask(; brain=false, ventricles=false, tumor=false) = \n    SimpleBrainMask(brain, ventricles, tumor)\n\n# Helper function for mask (returns 1.0 if enabled, 0.0 otherwise)\nfunction get_intensity(mask::SimpleBrainMask, tissue::Symbol)\n    if tissue == :brain && mask.brain\n        return 1.0f0\n    elseif tissue == :ventricles && mask.ventricles\n        return 1.0f0\n    elseif tissue == :tumor && mask.tumor\n        return 1.0f0\n    else\n        return 0.0f0\n    end\nend\nnothing # hide","category":"section"},{"location":"advanced/custom_phantoms/#Step-3:-Create-Rendering-Function","page":"Custom Phantoms","title":"Step 3: Create Rendering Function","text":"Now create the main function that ties everything together:\n\nfunction create_simple_brain_phantom(\n    nx::Int, ny::Int, nz::Int;\n    fovs::NTuple{3, Float32} = (2.0f0, 2.0f0, 2.0f0),\n    geometry::SimpleBrainGeometry = SimpleBrainGeometry(),\n    intensities = SimpleBrainIntensities(),\n    eltype::Type = Float32\n)\n    # Initialize phantom array\n    phantom = zeros(eltype, nx, ny, nz)\n    \n    # Create coordinate axes in physical space\n    ax_x = collect(range(-fovs[1]/2, fovs[1]/2, length=nx))\n    ax_y = collect(range(-fovs[2]/2, fovs[2]/2, length=ny))\n    ax_z = collect(range(-fovs[3]/2, fovs[3]/2, length=nz))\n    \n    # Get shapes with their intensities\n    shapes = get_brain_shapes(geometry, intensities)\n    \n    # Draw each shape onto the phantom\n    for shape in shapes\n        draw!(phantom, ax_x, ax_y, ax_z, shape)\n    end\n    \n    return phantom\nend\n\n# Create the phantom\nbrain_phantom = create_simple_brain_phantom(128, 128, 128)\nprintln(\"Brain phantom created with size: $(size(brain_phantom))\")\nnothing # hide","category":"section"},{"location":"advanced/custom_phantoms/#Step-4:-Visualize-Your-Custom-Result","page":"Custom Phantoms","title":"Step 4: Visualize Your Custom Result","text":"# Extract center slices for all three planes\naxial_slice = brain_phantom[:, :, div(128, 2)]\ncoronal_slice = brain_phantom[:, div(128, 2), :]\nsagittal_slice = brain_phantom[div(128, 2), :, :]\n\n# Create a single row plot with three images\nfig = plot(layout=(1, 3), size=(1200, 400))\nheatmap!(fig[1], axial_slice', title=\"Axial\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[2], coronal_slice', title=\"Coronal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[3], sagittal_slice', title=\"Sagittal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\n\nsavefig(fig, \"custom_brain_views.png\"); nothing # hide\n\n(Image: custom_brain_views.png)\n\nYou can also create masks to extract specific structures:\n\n# Create a mask showing only the tumor\ntumor_mask = create_simple_brain_phantom(\n    128, 128, 128; \n    intensities=SimpleBrainMask(tumor=true)\n)\n\njim(tumor_mask[:, :, div(128, 2)]; title=\"Tumor Mask\")\nsavefig(\"custom_brain_tumor_mask.png\"); nothing # hide\n\n(Image: custom_brain_tumor_mask.png)","category":"section"},{"location":"advanced/custom_phantoms/#Key-Design-Principles","page":"Custom Phantoms","title":"Key Design Principles","text":"When building custom phantoms, follow these practices:","category":"section"},{"location":"advanced/custom_phantoms/#1.-Separate-Concerns","page":"Custom Phantoms","title":"1. Separate Concerns","text":"Geometry structure: Holds shape parameters\nIntensity structure: Holds tissue properties\nRendering function: Combines them into a phantom","category":"section"},{"location":"advanced/custom_phantoms/#2.-Coordinate-System","page":"Custom Phantoms","title":"2. Coordinate System","text":"Always work in physical space (cm), not voxel indices:\n\nx_coords = range(-fovs[1]/2, fovs[1]/2, length=nx)\n# Avoids confusion and makes phantoms independent of resolution","category":"section"},{"location":"advanced/custom_phantoms/#3.-Rendering-Order","page":"Custom Phantoms","title":"3. Rendering Order","text":"In masking mode, render in order from:\n\nLarge outer structures\nMedium interior structures\nSmall details/pathology last\n\nThis ensures later structures overwrite earlier ones correctly.","category":"section"},{"location":"advanced/custom_phantoms/#4.-Documentation","page":"Custom Phantoms","title":"4. Documentation","text":"Include docstrings explaining:\n\nPurpose of each parameter\nTypical values\nBiological meaning\n\nExample:\n\n\"\"\"\n    create_custom_phantom(nx, ny, nz; fovs=(20,20,20), geometry=..., intensities=...)\n\nCreate a custom phantom.\n\n# Arguments\n- `nx, ny, nz`: Grid dimensions\n- `fovs`: Field of view in cm (default: (20, 20, 20))\n- `geometry`: Geometry structure with shape parameters\n- `intensities`: Intensity structure with tissue values\n\n# Returns\n- `phantom::Array{Float32, 3}`: Generated phantom array\n\"\"\"","category":"section"},{"location":"advanced/custom_phantoms/#5.-Parameter-Validation","page":"Custom Phantoms","title":"5. Parameter Validation","text":"Validate inputs to catch errors early:\n\nfunction create_phantom(nx, ny, nz; ...)\n    nx > 0 || throw(ArgumentError(\"nx must be positive\"))\n    ny > 0 || throw(ArgumentError(\"ny must be positive\"))\n    nz > 0 || throw(ArgumentError(\"nz must be positive\"))\n    # ... rest of function\nend","category":"section"},{"location":"advanced/custom_phantoms/#Integration-into-the-Package","page":"Custom Phantoms","title":"Integration into the Package","text":"Once you've defined a custom phantom, you can integrate it with the package by:\n\nCreating a module file in src/\nDefining your geometry and intensity structures\nImplementing a public create_*_phantom function\nAdding tests to test/\nDocumenting in the guide (this page)\n\nThe package structure supports arbitrary custom phantoms while maintaining consistency with built-in phantoms.","category":"section"},{"location":"phantoms/tubes/#Tubes-Phantom","page":"Tubes Phantom","title":"Tubes Phantom","text":"The Tubes phantom is a geometric validation phantom consisting of concentric cylinders and tubes. It provides a simple, highly controlled test case for validating imaging methods, quality assurance procedures, and reconstruction algorithms. The phantom's geometric simplicity and precise mathematical definition make it ideal for testing resolution, uniformity, and artifact detection.","category":"section"},{"location":"phantoms/tubes/#Purpose-and-Use-Cases","page":"Tubes Phantom","title":"Purpose and Use Cases","text":"The Tubes phantom is particularly useful for:\n\nResolution assessment: Measure point spread function and edge sharpness\nLinearity testing: Verify accurate intensity representation across the phantom\nArtifact detection: Identify system-related artifacts independent of anatomical complexity\nMethod validation: Test new reconstruction algorithms on simple, well-defined geometry\nQuality control: Routine scanner and processing validation","category":"section"},{"location":"phantoms/tubes/#Example-Use-Case:-Multi-Echo-MRI","page":"Tubes Phantom","title":"Example Use Case: Multi-Echo MRI","text":"A notable use case for the tubes phantom is to simulate multi-echo MRI images, where the filling of each tube has different T1 and T2 relaxation constants. This allows testing T1/T2 mapping algorithms and analyzing signal decay across echoes in a controlled environment.\n\nUnlike anatomical phantoms, the Tubes phantom has a minimal number of tissues and well-defined geometric boundaries, making it easier to interpret results and attribute them to specific system components.","category":"section"},{"location":"phantoms/tubes/#Basic-Usage","page":"Tubes Phantom","title":"Basic Usage","text":"","category":"section"},{"location":"phantoms/tubes/#Default-Configuration","page":"Tubes Phantom","title":"Default Configuration","text":"Create a default Tubes phantom with standard geometry and intensities:\n\n# Create 3D phantom (outer cylinder with concentric tubes inside)\nphantom_3d = create_tubes_phantom(256, 256, 256)\njim(phantom_3d[:, :, div(end, 2)]; title=\"Tubes Phantom - Middle Slice\")\nsavefig(\"tubes_3d_slice.png\"); nothing # hide\n\n(Image: tubes_3d_slice.png)","category":"section"},{"location":"phantoms/tubes/#2D-Slices","page":"Tubes Phantom","title":"2D Slices","text":"Generate 2D slices at different orientations:\n\n# Axial slice\nphantom_axial = create_tubes_phantom(256, 256, :axial)\njim(phantom_axial; title=\"Tubes - Axial Slice\")\nsavefig(\"tubes_axial.png\"); nothing # hide\n\n(Image: tubes_axial.png)\n\n# Coronal slice\nphantom_coronal = create_tubes_phantom(256, 256, :coronal)\njim(phantom_coronal; title=\"Tubes - Coronal Slice\")\nsavefig(\"tubes_coronal.png\"); nothing # hide\n\n(Image: tubes_coronal.png)\n\n# Sagittal slice\nphantom_sagittal = create_tubes_phantom(256, 256, :sagittal)\njim(phantom_sagittal; title=\"Tubes - Sagittal Slice\")\nsavefig(\"tubes_sagittal.png\"); nothing # hide\n\n(Image: tubes_sagittal.png)","category":"section"},{"location":"phantoms/tubes/#Spatial-Slicing","page":"Tubes Phantom","title":"Spatial Slicing","text":"View the phantom from all three orthogonal planes:\n\nusing Plots\n\n# Create 3D phantom\nphantom_3d = create_tubes_phantom(128, 128, 128)\nnx, ny, nz = size(phantom_3d)\n\n# Extract center slices\naxial = phantom_3d[:, :, div(nz, 2)]\ncoronal = phantom_3d[:, div(ny, 2), :]\nsagittal = phantom_3d[div(nx, 2), :, :]\n\n# Plot all planes\np1 = heatmap(axial', title=\"Axial\", aspect_ratio=1, color=:grays, axis=false)\np2 = heatmap(coronal', title=\"Coronal\", aspect_ratio=1, color=:grays, axis=false)\np3 = heatmap(sagittal', title=\"Sagittal\", aspect_ratio=1, color=:grays, axis=false)\n\nplot(p1, p2, p3, layout=(1,3), size=(900, 300))\nsavefig(\"tubes_planes.png\"); nothing # hide\n\n(Image: tubes_planes.png)","category":"section"},{"location":"phantoms/tubes/#Geometry-Customization","page":"Tubes Phantom","title":"Geometry Customization","text":"Modify the phantom's geometric properties to suit your needs:\n\n# Create custom geometry\ncustom_geometry = TubesGeometry(\n    outer_radius=0.8,           # Outer cylinder radius in cm (default: 0.4)\n    outer_height=2.0,           # Outer cylinder height in cm (default: 0.8)\n    tubes_height_fraction=0.9,  # Tubes height as fraction of outer height\n    tube_wall_thickness=0.025,  # Wall thickness (default: 0.025)\n    gap_fraction=0.3            # Gap between tubes (default: 0.3)\n)\n\nphantom_custom_geom = create_tubes_phantom(256, 256, 256; tg=custom_geometry)\njim(phantom_custom_geom[:, :, div(end, 2)]; title=\"Custom Geometry\")\nsavefig(\"tubes_custom_geometry.png\"); nothing # hide\n\n(Image: tubes_custom_geometry.png)","category":"section"},{"location":"phantoms/tubes/#Intensity-Customization","page":"Tubes Phantom","title":"Intensity Customization","text":"Adjust tissue intensities to match your imaging protocol:\n\n# Default intensities\ncustom_intensities = TubesIntensities(\n    outer_cylinder=0.25,\n    tube_wall=0.0,\n    tube_fillings=[0.2, 0.4, 0.6, 0.8, 1.0]  # Different intensity for each tube\n)\n\nphantom_custom_intensity = create_tubes_phantom(256, 256, 256; ti=custom_intensities)\njim(phantom_custom_intensity[:, :, div(end, 2)]; title=\"Custom Intensities\")\nsavefig(\"tubes_custom_intensity.png\"); nothing # hide\n\n(Image: tubes_custom_intensity.png)","category":"section"},{"location":"phantoms/tubes/#Multi-Frame-Stack-Generation","page":"Tubes Phantom","title":"Multi-Frame Stack Generation","text":"Create phantoms with multiple intensity levels for sensitivity or linearity testing:\n\n# Create stack with different intensity variations\nintensity_stack = [\n    TubesIntensities(outer_cylinder=0.1, tube_fillings=[0.05, 0.1, 0.15, 0.2, 0.25]),\n    TubesIntensities(outer_cylinder=0.25, tube_fillings=[0.1, 0.2, 0.3, 0.4, 0.5]),\n    TubesIntensities(outer_cylinder=0.5, tube_fillings=[0.2, 0.4, 0.6, 0.8, 1.0]),\n    TubesIntensities(outer_cylinder=0.75, tube_fillings=[0.3, 0.6, 0.9, 1.2, 1.5])\n]\n\nphantom_stack = create_tubes_phantom(256, 256, 256; ti=intensity_stack)\n\n# Stack has shape (256, 256, 256, 4) - 4 different intensity configurations\nprintln(\"Stack shape: $(size(phantom_stack))\")\n\n# Visualize each frame\nfor i in 1:size(phantom_stack, 4)\n    frame = phantom_stack[:, :, div(end, 2), i]\n    println(\"Frame $i - Min: $(round(minimum(frame), digits=3)), Max: $(round(maximum(frame), digits=3))\")\nend\nnothing # hide\n\nThis creates a 4D array where each 3D volume represents a phantom with different intensities, useful for testing linearity across a range of signal magnitudes.","category":"section"},{"location":"phantoms/tubes/#Advanced-Applications","page":"Tubes Phantom","title":"Advanced Applications","text":"","category":"section"},{"location":"phantoms/tubes/#Linearity-Testing","page":"Tubes Phantom","title":"Linearity Testing","text":"Use the multi-frame stack to test signal linearity:\n\nusing Statistics\n\n# Create phantoms with proportional intensities\nintensities_linear = [\n    TubesIntensities(outer_cylinder=i*0.1, tube_fillings=fill(i*0.1, 6))\n    for i in 1:10\n]\n\nphantom_linearity = create_tubes_phantom(256, 256, 256; ti=intensities_linear)\n\n# Measure mean signal in each frame\nmean_signals = [mean(phantom_linearity[:, :, div(end, 2), i]) for i in 1:10]\n\n# Plot linearity\nplot(1:10, mean_signals, \n    xlabel=\"Intensity Scale Factor\",\n    ylabel=\"Measured Signal\",\n    title=\"Linearity Test\",\n    legend=false)\nsavefig(\"tubes_linearity.png\"); nothing # hide\n\n(Image: tubes_linearity.png)","category":"section"},{"location":"phantoms/tubes/#Resolution-Assessment","page":"Tubes Phantom","title":"Resolution Assessment","text":"Examine fine details at different resolution levels:\n\n# Low resolution (fast to compute, useful for quick tests)\ntubes_64 = create_tubes_phantom(64, 64, 64)\n\n# Medium resolution\ntubes_256 = create_tubes_phantom(256, 256, 256)\n\n# High resolution (slow but maximum detail)\ntubes_512 = create_tubes_phantom(512, 512, 512)\n\np1 = jim(tubes_64[:, :, div(end, 2)]; title=\"64×64×64\")\np2 = jim(tubes_256[:, :, div(end, 2)]; title=\"256×256×256\")\np3 = jim(tubes_512[:, :, div(end, 2)]; title=\"512×512×512\")\nplot(p1, p2, p3, layout=(1,3), size=(1200,300))\nsavefig(\"tubes_resolution_comparison.png\"); nothing # hide\n\n(Image: tubes_resolution_comparison.png)","category":"section"},{"location":"phantoms/shepp_logan/#Shepp-Logan-Phantom","page":"Shepp-Logan Phantom","title":"Shepp-Logan Phantom","text":"The Shepp-Logan phantom is the classic test phantom in medical imaging. First introduced by Shepp and Logan in 1974, it represents a simplified model of the human head using overlapping ellipses, making it ideal for testing image reconstruction algorithms and understanding imaging physics.","category":"section"},{"location":"phantoms/shepp_logan/#History-and-Design-Philosophy","page":"Shepp-Logan Phantom","title":"History and Design Philosophy","text":"The original phantom (Shepp & Logan, 1974) was designed as a synthetic test image for CT reconstruction, composed of 10 ellipses with different attenuation coefficients. In 1988, Kak and Slaney popularized its use in the context of filtered backprojection algorithms, and defined a 3D version using ellipsoids. It became the standard test case because:\n\nSimplicity: Easy to generate and understand\nReproducibility: Well-defined mathematical structure enables precise comparisons\n\nThe MRI variant (Toft, 1996) adapted intensity values for nuclear magnetic resonance instead of X-ray attenuation, scaling to realistic MRI signal ranges.\n\nCompared to Kak & Slaney's implementation, GeometricMedicalPhantoms differs by the following design choices:\n\nAdditional ellipsoids: Includes two extra ellipsoids to approximately match with the original 2D Shepp & Logan design (suggested by Lei Shu <leizhu@stanford.edu>).\nShift in z-axis by 0.25: This adjustment makes the connection between the original 2D phantom and the 3D volume more intuitive by centering the axial slice that matches the 2D phantom.","category":"section"},{"location":"phantoms/shepp_logan/#Comparison-with-ImagePhantoms.jl","page":"Shepp-Logan Phantom","title":"Comparison with ImagePhantoms.jl","text":"Both the 2D and the 3D Shepp-Logan phantoms are also available in the ImagePhantoms.jl package. For higher precision, one might prefer ImagePhantoms.jl, which samples the analytical definition in Fourier or Randon space directly. GeometricMedicalPhantoms.jl, however, provides more flexibility over geometry and intensity customization, and have been optimized for fast voxel-based rendering.","category":"section"},{"location":"phantoms/shepp_logan/#Basic-Usage","page":"Shepp-Logan Phantom","title":"Basic Usage","text":"","category":"section"},{"location":"phantoms/shepp_logan/#2D-Slices","page":"Shepp-Logan Phantom","title":"2D Slices","text":"Generate a 2D Shepp-Logan phantom at any orientation:\n\n# Create axial (horizontal) slice\nphantom_axial = create_shepp_logan_phantom(256, 256, :axial)\njim(phantom_axial; title=\"Axial View\", clim=(0.95, 1.05), yflip=false)\nsavefig(\"shepp_logan_axial.png\"); nothing # hide\n\n(Image: shepp_logan_axial.png)\n\n# Create coronal (front-to-back) slice\nphantom_coronal = create_shepp_logan_phantom(256, 256, :coronal)\njim(phantom_coronal; title=\"Coronal View\", clim=(0.95, 1.05), yflip=false)\nsavefig(\"shepp_logan_coronal.png\"); nothing # hide\n\n(Image: shepp_logan_coronal.png)\n\n# Create sagittal (left-right) slice\nphantom_sagittal = create_shepp_logan_phantom(256, 256, :sagittal)\njim(phantom_sagittal; title=\"Sagittal View\", clim=(0.95, 1.05), yflip=false)\nsavefig(\"shepp_logan_sagittal.png\"); nothing # hide\n\n(Image: shepp_logan_sagittal.png)","category":"section"},{"location":"phantoms/shepp_logan/#3D-Volume","page":"Shepp-Logan Phantom","title":"3D Volume","text":"Generate a full 3D phantom:\n\nphantom_3d = create_shepp_logan_phantom(128, 128, 128)\nprintln(\"Phantom shape: $(size(phantom_3d))\")\nprintln(\"Min value: $(minimum(phantom_3d))\")\nprintln(\"Max value: $(maximum(phantom_3d))\")\nnothing # hide\n\nCreate spatial slicing GIF showing all slices through the volume:\n\nusing FileIO, ImageIO, ImageMagick\n\n# Create axial slices GIF (loop through z-axis)\nnx, ny, nz = size(phantom_3d)\nframes_axial = zeros(UInt8, nx, ny, nz)\n\nfor i in 1:nz\n    slice = abs.(phantom_3d[:, :, i])\n    frames_axial[:, :, i] = map(x -> UInt8(round((clamp(x, 0.95, 1.05) - 0.95) / 0.1 * 255)), slice)\nend\n\nsave(\"shepp_logan_axial_slices.gif\", frames_axial, fps=10)\nnothing # hide\n\n(Image: shepp_logan_axial_slices.gif)\n\n# Create coronal slices GIF (loop through y-axis)\nframes_coronal = zeros(UInt8, nx, nz, ny)\nfor i in 1:ny\n    slice = abs.(phantom_3d[:, i, :])\n    frames_coronal[:, :, i] = map(x -> UInt8(round((clamp(x, 0.95, 1.05) - 0.95) / 0.1 * 255)), slice)\nend\n\nsave(\"shepp_logan_coronal_slices.gif\", frames_coronal, fps=10)\nnothing # hide\n\n(Image: shepp_logan_coronal_slices.gif)\n\n# Create sagittal slices GIF (loop through x-axis)\nframes_sagittal = zeros(UInt8, ny, nz, nx)\nfor i in 1:nx\n    slice = abs.(phantom_3d[i, :, :])\n    frames_sagittal[:, :, i] = map(x -> UInt8(round((clamp(x, 0.95, 1.05) - 0.95) / 0.1 * 255)), slice)\nend\n\nsave(\"shepp_logan_sagittal_slices.gif\", frames_sagittal, fps=10)\nnothing # hide\n\n(Image: shepp_logan_sagittal_slices.gif)","category":"section"},{"location":"phantoms/shepp_logan/#Intensity-Variants","page":"Shepp-Logan Phantom","title":"Intensity Variants","text":"The package provides different intensity scaling options:","category":"section"},{"location":"phantoms/shepp_logan/#CT-Intensities-(Original-Shepp-Logan)","page":"Shepp-Logan Phantom","title":"CT Intensities (Original Shepp-Logan)","text":"phantom_ct = create_shepp_logan_phantom(256, 256, :axial; ti=CTSheppLoganIntensities())\njim(phantom_ct; title=\"CT Shepp-Logan\", clim=(0.95, 1.05), yflip=false)\nsavefig(\"shepp_logan_ct.png\"); nothing # hide\n\n(Image: shepp_logan_ct.png)\n\nThis uses the original Shepp & Logan (1974) attenuation coefficients adapted for CT imaging.","category":"section"},{"location":"phantoms/shepp_logan/#MRI-Intensities-(Toft-1996)","page":"Shepp-Logan Phantom","title":"MRI Intensities (Toft 1996)","text":"phantom_mri = create_shepp_logan_phantom(256, 256, :axial; ti=MRISheppLoganIntensities())\njim(phantom_mri; title=\"MRI Shepp-Logan\", yflip=false)\nsavefig(\"shepp_logan_mri.png\"); nothing # hide\n\n(Image: shepp_logan_mri.png)\n\nThe MRI version from Toft's PhD thesis (1996) provides intensity values suited for nuclear magnetic resonance imaging.","category":"section"},{"location":"phantoms/shepp_logan/#Custom-Intensities","page":"Shepp-Logan Phantom","title":"Custom Intensities","text":"You can create custom intensity values:\n\nusing GeometricMedicalPhantoms: SheppLoganIntensities\n\n# Create custom intensities with your own values\ncustom_intensities = SheppLoganIntensities(\n    skull=1.5,\n    brain=0.5,\n    right_big=-0.1,\n    left_big=-0.1,\n    top=0.2,\n    middle_high=0.2,\n    bottom_left=0.2,\n    middle_low=0.2,\n    bottom_center=0.2,\n    bottom_right=0.2,\n    extra_1=0.3,\n    extra_2=-0.1\n)\n\nphantom_custom = create_shepp_logan_phantom(256, 256, :axial; ti=custom_intensities)\njim(phantom_custom; title=\"Custom Intensities\", yflip=false)\nsavefig(\"shepp_logan_custom.png\"); nothing # hide\n\n(Image: shepp_logan_custom.png)","category":"section"},{"location":"phantoms/shepp_logan/#Tissue-Masking","page":"Shepp-Logan Phantom","title":"Tissue Masking","text":"Extract masks for specific anatomical regions:\n\n# Create mask of the skull\nskull_mask = create_shepp_logan_phantom(256, 256, :axial; ti=SheppLoganMask(skull=true))\njim(skull_mask; title=\"Skull Mask\", yflip=false)\nsavefig(\"shepp_logan_skull_mask.png\"); nothing # hide\n\n(Image: shepp_logan_skull_mask.png)\n\n# Create mask of the brain\nbrain_mask = create_shepp_logan_phantom(256, 256, :axial; ti=SheppLoganMask(brain=true))\njim(brain_mask; title=\"Brain Mask\", yflip=false)\nsavefig(\"shepp_logan_brain_mask.png\"); nothing # hide\n\n(Image: shepp_logan_brain_mask.png)\n\n# Create combined mask of brain structures\nstructures_mask = create_shepp_logan_phantom(256, 256, :axial; \n    ti=SheppLoganMask(brain=true, right_big=true, left_big=true))\njim(structures_mask; title=\"Brain Structures\", yflip=false)\nsavefig(\"shepp_logan_structures_mask.png\"); nothing # hide\n\n(Image: shepp_logan_structures_mask.png)","category":"section"},{"location":"phantoms/shepp_logan/#Advanced-Parameters","page":"Shepp-Logan Phantom","title":"Advanced Parameters","text":"","category":"section"},{"location":"phantoms/shepp_logan/#Resolution-and-Field-of-View","page":"Shepp-Logan Phantom","title":"Resolution and Field of View","text":"Control the resolution and spatial extent:\n\n# Low resolution\nphantom_low = create_shepp_logan_phantom(64, 64, :axial)\n\n# High resolution\nphantom_high = create_shepp_logan_phantom(512, 512, :axial)\n\np1 = jim(phantom_low; title=\"Low Res (64×64)\", clim=(0.95, 1.05), yflip=false)\np2 = jim(phantom_high; title=\"High Res (512×512)\", clim=(0.95, 1.05), yflip=false)\nplot(p1, p2, layout=(1,2), size=(1000,400))\nsavefig(\"shepp_logan_resolution.png\"); nothing # hide\n\n(Image: shepp_logan_resolution.png)","category":"section"},{"location":"phantoms/shepp_logan/#Custom-Field-of-View","page":"Shepp-Logan Phantom","title":"Custom Field of View","text":"# Smaller FOV (zoomed in)\nphantom_small_fov = create_shepp_logan_phantom(256, 256, :axial; fovs=(10.0, 10.0))\n\n# Larger FOV (zoomed out)\nphantom_large_fov = create_shepp_logan_phantom(256, 256, :axial; fovs=(30.0, 30.0))\n\np1 = jim(phantom_small_fov; title=\"Small FOV (10cm)\", clim=(0.95, 1.05), yflip=false)\np2 = jim(phantom_large_fov; title=\"Large FOV (30cm)\", clim=(0.95, 1.05), yflip=false)\nplot(p1, p2, layout=(1,2), size=(1000,400))\nsavefig(\"shepp_logan_fov.png\"); nothing # hide\n\n(Image: shepp_logan_fov.png)","category":"section"},{"location":"phantoms/shepp_logan/#Data-Type","page":"Shepp-Logan Phantom","title":"Data Type","text":"Control the output data type and create specific masks:\n\nphantom_f32 = create_shepp_logan_phantom(256, 256, :axial; eltype=Float32)\nphantom_f64 = create_shepp_logan_phantom(256, 256, :axial; eltype=Float64)\n# Create a mask where only skull and top ellipsoids are selected\nphantom_mask = create_shepp_logan_phantom(256, 256, :axial; ti=SheppLoganMask(skull=true, top=true))\n\nprintln(\"Float32: $(typeof(phantom_f32))\")\nprintln(\"Float64: $(typeof(phantom_f64))\")\nprintln(\"Mask (Bool): $(typeof(phantom_mask))\")\n\njim(phantom_mask; title=\"Skull + Top Mask\", yflip=false)\nsavefig(\"shepp_logan_mask_example.png\"); nothing # hide\n\n(Image: shepp_logan_mask_example.png)","category":"section"},{"location":"advanced/primitives/#Geometry-Primitives","page":"Geometry Primitives","title":"Geometry Primitives","text":"GeometricMedicalPhantoms is built on a foundation of geometric primitives: simple mathematical shapes that can be combined to create complex phantoms. Understanding these primitives is essential for building custom phantoms.","category":"section"},{"location":"advanced/primitives/#Overview","page":"Geometry Primitives","title":"Overview","text":"All phantoms are ultimately composed of collections of geometric primitives that are rendered at each voxel. The available primitives are:\n\nEllipsoid: General 3D elliptical shape (axis-aligned)\nSuperEllipsoid: Generalized ellipsoid with adjustable curvature\nRotatedEllipsoid: Ellipsoid with arbitrary 3D rotation\nCylinderX, CylinderY, CylinderZ: Cylinders aligned with coordinate axes\n\nEach primitive is defined by a set of parameters (center, size, intensity) and a mathematical function that determines whether a point in space belongs to the shape.","category":"section"},{"location":"advanced/primitives/#Ellipsoid","page":"Geometry Primitives","title":"Ellipsoid","text":"An ellipsoid is a generalization of a sphere to three dimensions with potentially different radii in each direction.","category":"section"},{"location":"advanced/primitives/#Mathematical-Definition","page":"Geometry Primitives","title":"Mathematical Definition","text":"An ellipsoid centered at (c_x c_y c_z) with radii (r_x r_y r_z) is defined by:\n\nleft(fracx - c_xr_xright)^2 + left(fracy - c_yr_yright)^2 + left(fracz - c_zr_zright)^2 leq 1\n\nA point is inside the ellipsoid if the left side is ≤ 1, and outside otherwise.","category":"section"},{"location":"advanced/primitives/#Parameters","page":"Geometry Primitives","title":"Parameters","text":"# Create a simple ellipsoid\n# Ellipsoid(cx, cy, cz, rx, ry, rz, intensity)\nell = Ellipsoid(0.0, 0.0, 0.0, 1.0, 0.5, 0.8, 1.0)\n\nprintln(\"Ellipsoid: $ell\")\nnothing # hide","category":"section"},{"location":"advanced/primitives/#Visual-Example","page":"Geometry Primitives","title":"Visual Example","text":"# Draw a phantom containing a single ellipsoid\nprimitives = [\n    Ellipsoid(0.0, 0.0, 0.0, 0.8, 0.6, 0.5, 1.0)\n]\n\n# Create simple 2D drawing function for visualization\nphantom_2d = zeros(Float32, 128, 128)\nfor i in 1:128\n    for j in 1:128\n        x = (i - 64) / 64  # Map to [-1, 1]\n        y = (j - 64) / 64\n        z = 0.0  # Center z-slice\n        \n        for prim in primitives\n            # Simple point-in-ellipsoid test\n            dx, dy, dz = x - prim.cx, y - prim.cy, z - prim.cz\n            if (dx/prim.rx)^2 + (dy/prim.ry)^2 + (dz/prim.rz)^2 <= 1.0\n                phantom_2d[i, j] = prim.intensity\n            end\n        end\n    end\nend\n\njim(phantom_2d; title=\"Single Ellipsoid\")\nsavefig(\"ellipsoid_example.png\"); nothing # hide\n\n(Image: ellipsoid_example.png)","category":"section"},{"location":"advanced/primitives/#Use-Cases","page":"Geometry Primitives","title":"Use Cases","text":"Ellipsoids are used throughout the Shepp-Logan phantom (12 ellipses) and are suitable for:\n\nAnatomical structures with roughly elliptical cross-sections (brain, organs)\nLesions and tumors\nCysts and other pathological structures","category":"section"},{"location":"advanced/primitives/#SuperEllipsoid","page":"Geometry Primitives","title":"SuperEllipsoid","text":"A SuperEllipsoid generalizes the ellipsoid by introducing adjustable exponents. This allows creating shapes ranging from perfect spheres to rounded boxes.","category":"section"},{"location":"advanced/primitives/#Mathematical-Definition-2","page":"Geometry Primitives","title":"Mathematical Definition","text":"A SuperEllipsoid centered at (c_x c_y c_z) with radii (r_x r_y r_z) and exponents (e_x e_y e_z) is defined by:\n\nleftfracx - c_xr_xright^e_x + leftfracy - c_yr_yright^e_y + leftfracz - c_zr_zright^e_z leq 1\n\nWhen all exponents equal 2, this reduces to the standard ellipsoid. As exponents increase, the shape becomes more \"boxy\"; as they decrease toward 1, it becomes more \"pointy.\"","category":"section"},{"location":"advanced/primitives/#Parameters-2","page":"Geometry Primitives","title":"Parameters","text":"# SuperEllipsoid with adjustable curvature\n# SuperEllipsoid(cx, cy, cz, rx, ry, rz, (ex, ey, ez), intensity)\nsuper_ell = SuperEllipsoid(0.0, 0.0, 0.0, 1.0, 0.8, 0.6, (2.0, 2.0, 2.0), 0.8)\n\nprintln(\"SuperEllipsoid: $super_ell\")\nnothing # hide","category":"section"},{"location":"advanced/primitives/#Effect-of-Exponents","page":"Geometry Primitives","title":"Effect of Exponents","text":"# Create phantoms with different exponents to show shape variation\nfig_superell = plot(layout=(2,2), size=(800,800))\n\nexponents_list = [(2.0, 2.0, 2.0), (1.5, 1.5, 1.5), (2.5, 2.5, 2.5), (3.0, 3.0, 3.0)]\nexponent_labels = [\"Standard (2,2,2)\", \"Pointy (1.5,1.5,1.5)\", \"Rounded (2.5,2.5,2.5)\", \"Boxy (3,3,3)\"]\n\nfor (idx, (exp, label)) in enumerate(zip(exponents_list, exponent_labels))\n    phantom_super = zeros(Float32, 128, 128)\n    for i in 1:128\n        for j in 1:128\n            x = (i - 64) / 64\n            y = (j - 64) / 64\n            z = 0.0\n            \n            # SuperEllipsoid point test\n            dx, dy, dz = x, y, z\n            if abs(dx/1.0)^exp[1] + abs(dy/0.8)^exp[2] + abs(dz/0.6)^exp[3] <= 1.0\n                phantom_super[i, j] = 1.0\n            end\n        end\n    end\n    \n    # Plot in subplot\n    heatmap!(fig_superell[idx], phantom_super', title=label, aspect_ratio=:equal, color=:grays)\nend\n\nsavefig(fig_superell, \"superellipsoid_exponents.png\"); nothing # hide\n\n(Image: superellipsoid_exponents.png)","category":"section"},{"location":"advanced/primitives/#Use-Cases-2","page":"Geometry Primitives","title":"Use Cases","text":"SuperEllipsoids are useful for:\n\nAnatomical structures with non-standard curvature\nRounded rectangles (boxes with rounded corners)\nOrganic shapes that are smoother or more angular than pure ellipsoids\nCreating variety in phantom designs while maintaining mathematical clarity","category":"section"},{"location":"advanced/primitives/#RotatedEllipsoid","page":"Geometry Primitives","title":"RotatedEllipsoid","text":"A RotatedEllipsoid allows arbitrary 3D rotation of an ellipsoid using Euler angles.","category":"section"},{"location":"advanced/primitives/#Mathematical-Definition-3","page":"Geometry Primitives","title":"Mathematical Definition","text":"A RotatedEllipsoid is defined by:\n\nStandard ellipsoid equation after coordinate transformation\nRotation matrix R applied using Z-Y-X Euler angles (in radians)\n\nThe condition becomes: (R^-1(P - C))^T D (R^-1(P - C)) leq 1\n\nwhere C is the center, D is the diagonal matrix of (1r_x^2 1r_y^2 1r_z^2), and R is the Z-Y-X rotation.","category":"section"},{"location":"advanced/primitives/#Parameters-3","page":"Geometry Primitives","title":"Parameters","text":"# RotatedEllipsoid with 3D orientation\n# RotatedEllipsoid(cx, cy, cz, rx, ry, rz, phi, theta, psi, intensity)\nrot_ell = RotatedEllipsoid(0.0, 0.0, 0.0, 0.8, 0.4, 0.3, 0.3, 0.4, 0.2, 0.7)\n\nprintln(\"RotatedEllipsoid: $rot_ell\")\nnothing # hide","category":"section"},{"location":"advanced/primitives/#Rotation-Angles","page":"Geometry Primitives","title":"Rotation Angles","text":"Rotations are specified using Euler angles in Z-Y-X order (phi, theta, psi).\n\n# Demonstrate rotation angles\nusing GeometricMedicalPhantoms\n\n# Create axes\nnx, ny, nz = 128, 128, 128\nax = collect(range(-1.0, 1.0, length=nx))\n\n# Helper function to create and draw an ellipsoid\nfunction draw_ellipsoid(phi, theta, psi, title_str)\n    phantom = zeros(Float32, nx, ny, nz)\n    # Using internal MaskingIntensityValue wrapper\n    ellipsoid = GeometricMedicalPhantoms.RotatedEllipsoid(\n        0.0, 0.0, 0.0,  # center\n        0.3, 0.1, 0.3,  # radii\n        phi, theta, psi,  # rotations\n        GeometricMedicalPhantoms.MaskingIntensityValue(1.0f0)  # intensity\n    )\n    GeometricMedicalPhantoms.draw!(phantom, ax, ax, ax, ellipsoid)\n    slice = phantom[:, :, 64]\n    return heatmap(slice', title=title_str, aspect_ratio=:equal, color=:grays, legend=false)\nend\n\n# Create visualizations\np1 = draw_ellipsoid(0.0, 0.0, 0.0, \"No Rotation\")\np2 = draw_ellipsoid(π/4, 0.0, 0.0, \"Z-Rotation (π/4)\")\n\nfig_rotations = plot(p1, p2, layout=(1,2), size=(1200,600))\nsavefig(fig_rotations, \"rotated_ellipsoid_example.png\"); nothing # hide\n\n(Image: rotated_ellipsoid_example.png)","category":"section"},{"location":"advanced/primitives/#Use-Cases-3","page":"Geometry Primitives","title":"Use Cases","text":"RotatedEllipsoids enable:\n\nObliquely oriented vessels and tubes\nAnatomically realistic organ orientations (e.g., liver, kidney)\nLesions aligned with anatomical axes\nRealistic representation of bone structures","category":"section"},{"location":"advanced/primitives/#Cylinders","page":"Geometry Primitives","title":"Cylinders","text":"Three varieties of cylinders, aligned with the coordinate axes:","category":"section"},{"location":"advanced/primitives/#CylinderZ-(Aligned-with-Z-axis)","page":"Geometry Primitives","title":"CylinderZ (Aligned with Z-axis)","text":"Extends along the Z-axis:\n\nsqrt(x - c_x)^2 + (y - c_y)^2 leq r text and  z - c_z leq fractextheight2\n\n# CylinderZ(cx, cy, cz, r, height, intensity)\ncyl_z = CylinderZ(0.0, 0.0, 0.0, 0.3, 1.0, 0.9)\n\nprintln(\"CylinderZ: $cyl_z\")\nnothing # hide","category":"section"},{"location":"advanced/primitives/#CylinderY-(Aligned-with-Y-axis)","page":"Geometry Primitives","title":"CylinderY (Aligned with Y-axis)","text":"Extends along the Y-axis:\n\nsqrt(x - c_x)^2 + (z - c_z)^2 leq r text and  y - c_y leq fractextheight2","category":"section"},{"location":"advanced/primitives/#CylinderX-(Aligned-with-X-axis)","page":"Geometry Primitives","title":"CylinderX (Aligned with X-axis)","text":"Extends along the X-axis:\n\nsqrt(y - c_y)^2 + (z - c_z)^2 leq r text and  x - c_x leq fractextheight2","category":"section"},{"location":"advanced/primitives/#Visual-Example-2","page":"Geometry Primitives","title":"Visual Example","text":"# Create 3D phantom volumes with each cylinder type\nnx, ny, nz = 64, 64, 64\nfov = 2.0\nax_x = collect(range(-fov/2, fov/2, length=nx))\nax_y = collect(range(-fov/2, fov/2, length=ny))\nax_z = collect(range(-fov/2, fov/2, length=nz))\n\n# CylinderZ (extends along Z-axis)\ncyl_z = CylinderZ(0.0, 0.0, 0.0, 0.3, 1.2, 1.0)\nphantom_z = zeros(Float32, nx, ny, nz)\ndraw!(phantom_z, ax_x, ax_y, ax_z, cyl_z)\n\n# CylinderY (extends along Y-axis)\ncyl_y = CylinderY(0.0, 0.0, 0.0, 0.3, 1.2, 1.0)\nphantom_y = zeros(Float32, nx, ny, nz)\ndraw!(phantom_y, ax_x, ax_y, ax_z, cyl_y)\n\n# CylinderX (extends along X-axis)\ncyl_x = CylinderX(0.0, 0.0, 0.0, 0.3, 1.2, 1.0)\nphantom_x = zeros(Float32, nx, ny, nz)\ndraw!(phantom_x, ax_x, ax_y, ax_z, cyl_x)\n\n# Create 3x3 layout: rows are cylinder types, columns are planes\nfig = plot(layout=(3,3), size=(1200,1200))\n\n# CylinderZ slices\nheatmap!(fig[1,1], phantom_z[:, :, div(nz,2)]', title=\"CylinderZ - Axial\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[1,2], phantom_z[:, div(ny,2), :]', title=\"CylinderZ - Coronal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[1,3], phantom_z[div(nx,2), :, :]', title=\"CylinderZ - Sagittal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\n\n# CylinderY slices\nheatmap!(fig[2,1], phantom_y[:, :, div(nz,2)]', title=\"CylinderY - Axial\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[2,2], phantom_y[:, div(ny,2), :]', title=\"CylinderY - Coronal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[2,3], phantom_y[div(nx,2), :, :]', title=\"CylinderY - Sagittal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\n\n# CylinderX slices\nheatmap!(fig[3,1], phantom_x[:, :, div(nz,2)]', title=\"CylinderX - Axial\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[3,2], phantom_x[:, div(ny,2), :]', title=\"CylinderX - Coronal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\nheatmap!(fig[3,3], phantom_x[div(nx,2), :, :]', title=\"CylinderX - Sagittal\", aspect_ratio=:equal, color=:grays, legend=false, axis=false)\n\nsavefig(fig, \"cylinders_example.png\"); nothing # hide\n\n(Image: cylinders_example.png)","category":"section"},{"location":"advanced/primitives/#Use-Cases-4","page":"Geometry Primitives","title":"Use Cases","text":"Cylinders represent:\n\nBlood vessels\nAnatomical tubes (airways, ducts)\nSymmetric structures\nValidation phantoms (constant cross-section)","category":"section"},{"location":"advanced/primitives/#Implementing-New-Shapes","page":"Geometry Primitives","title":"Implementing New Shapes","text":"To add a new geometric primitive to GeometricMedicalPhantoms, you need to implement the following:","category":"section"},{"location":"advanced/primitives/#1.-Define-the-Shape-Structure","page":"Geometry Primitives","title":"1. Define the Shape Structure","text":"Create a struct that inherits from GeometricMedicalPhantoms.Shape:\n\nstruct MyCustomShape{T,T2} <: GeometricMedicalPhantoms.Shape\n    # Position parameters\n    cx::T\n    cy::T\n    cz::T\n    \n    # Shape-specific parameters\n    param1::T\n    param2::T\n    \n    # Intensity\n    intensity::T2\nend","category":"section"},{"location":"advanced/primitives/#2.-Implement-Rotation-Functions","page":"Geometry Primitives","title":"2. Implement Rotation Functions","text":"For 2D slicing support, implement coordinate transformations:\n\n# Coronal view: swap y and z\nGeometricMedicalPhantoms.rotate_coronal(shape::MyCustomShape) = \n    MyCustomShape(shape.cx, shape.cz, shape.cy, shape.param1, shape.param2, shape.intensity)\n\n# Sagittal view: swap x with z, then y with x\nGeometricMedicalPhantoms.rotate_sagittal(shape::MyCustomShape) = \n    MyCustomShape(shape.cy, shape.cz, shape.cx, shape.param1, shape.param2, shape.intensity)","category":"section"},{"location":"advanced/primitives/#3.-Implement-the-draw!-Function","page":"Geometry Primitives","title":"3. Implement the draw! Function","text":"This is the core rendering function. It should:\n\nCalculate bounding box for efficiency\nIterate only over relevant voxels\nTest if each point is inside the shape\nCall draw_pixel! to set the intensity\n\nfunction GeometricMedicalPhantoms.draw!(\n    phantom::AbstractArray{T,3}, \n    ax_x::AbstractVector, \n    ax_y::AbstractVector, \n    ax_z::AbstractVector,\n    shape::MyCustomShape\n) where T\n    # Extract parameters\n    cx, cy, cz = shape.cx, shape.cy, shape.cz\n    param1, param2 = shape.param1, shape.param2\n    intensity = shape.intensity\n    \n    # Calculate bounding box to avoid checking all voxels\n    # Use idx_bounds from utils.jl\n    ix_min, ix_max = GeometricMedicalPhantoms.idx_bounds(ax_x, cx, radius_x)\n    iy_min, iy_max = GeometricMedicalPhantoms.idx_bounds(ax_y, cy, radius_y)\n    iz_min, iz_max = GeometricMedicalPhantoms.idx_bounds(ax_z, cz, radius_z)\n    \n    # Early exit if shape is outside phantom\n    if ix_min == -1 || iy_min == -1 || iz_min == -1\n        return\n    end\n    \n    # Iterate over bounding box\n    for iz in iz_min:iz_max, iy in iy_min:iy_max, ix in ix_min:ix_max\n        x, y, z = ax_x[ix], ax_y[iy], ax_z[iz]\n        \n        # Test if point is inside shape\n        # This is shape-specific mathematical condition\n        if inside_shape_test(x, y, z, cx, cy, cz, param1, param2)\n            # Use draw_pixel! which handles Additive vs Masking modes\n            GeometricMedicalPhantoms.draw_pixel!(phantom, intensity, ix, iy, iz)\n        end\n    end\n    \n    return phantom\nend","category":"section"},{"location":"advanced/primitives/#4.-Implement-2D-Slicing-Support-(Optional)","page":"Geometry Primitives","title":"4. Implement 2D Slicing Support (Optional)","text":"For 2D slice support at arbitrary positions:\n\nfunction GeometricMedicalPhantoms.draw!(\n    phantom::AbstractArray{T,2},\n    ax_1::AbstractVector,\n    ax_2::AbstractVector,\n    ax_3_val::Real,  # Fixed coordinate value\n    shape::MyCustomShape\n) where T\n    # Similar to 3D but with fixed coordinate\n    # Iterate over 2D grid and test if points at ax_3_val are inside shape\nend","category":"section"},{"location":"advanced/primitives/#5.-Add-Documentation","page":"Geometry Primitives","title":"5. Add Documentation","text":"Add docstrings explaining:\n\nMathematical definition of the shape\nParameter meanings\nTypical use cases\n\n@doc raw\\\"\"\"\n    MyCustomShape(cx, cy, cz, param1, param2, intensity)\n\nCustom geometric shape for medical phantoms.\n\nThe shape is defined by the equation:\n``f(x, y, z) \\\\leq 1``\n\n# Fields\n- `cx, cy, cz`: Center position\n- `param1`: Description of parameter 1\n- `param2`: Description of parameter 2\n- `intensity`: Intensity value\n\n# Example\n\\```julia\nshape = MyCustomShape(0.0, 0.0, 0.0, 1.0, 0.5, 0.8)\n\\```\n\"\"\"","category":"section"},{"location":"advanced/primitives/#Example:-Complete-Implementation","page":"Geometry Primitives","title":"Example: Complete Implementation","text":"See the source code for Ellipsoid, CylinderZ, or SuperEllipsoid in the package for complete examples of shape implementations.","category":"section"},{"location":"#GeometricMedicalPhantoms.jl","page":"Home","title":"GeometricMedicalPhantoms.jl","text":"GeometricMedicalPhantoms provides tools for generating realistic medical imaging phantoms. These synthetic images are essential for testing reconstruction algorithms, validating imaging methods, and developing new acquisition strategies without requiring real patient data.","category":"section"},{"location":"#Why-Use-Phantoms?","page":"Home","title":"Why Use Phantoms?","text":"Phantoms are useful for:\n\nAlgorithm validation: Test reconstruction methods with known ground truth\nMethod comparison: Benchmark different imaging techniques\nQuality assurance: Verify scanner performance and image processing pipelines\nTeaching and learning: Understand MRI physics and acquisition concepts interactively\nResearch: Prototype new acquisition strategies and reconstruction approaches","category":"section"},{"location":"#Available-Phantoms","page":"Home","title":"Available Phantoms","text":"The package provides three distinct phantom types suited to different needs:\n\nPhantom Purpose Dimensions Features\nShepp-Logan Classic test phantom 2D slices or 3D volume Multiple intensity options, tissue masking\nTorso Anatomical realism 2D slices of 3D anatomy Heart, lungs, liver, vessels, physiological motion\nTubes Validation & QC 2D or 3D Geometric precision, customizable configuration","category":"section"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"Here's a typical workflow:\n\n# Create a Shepp-Logan phantom (2D axial slice)\nphantom_2d = create_shepp_logan_phantom(256, 256, :axial)\n\n# Visualize it\njim(phantom_2d; title=\"Shepp-Logan Phantom\", clim=(0.95, 1.05), yflip=false)\nsavefig(\"index_shepp_logan.png\"); nothing # hide\n\n(Image: index_shepp_logan.png)\n\n# Create a Torso phantom with anatomical details\ntorso = create_torso_phantom(128, 128, :coronal)\n\njim(torso; title=\"Torso (Coronal)\", yflip=false)\nsavefig(\"index_torso.png\"); nothing # hide\n\n(Image: index_torso.png)\n\n# Create a validation phantom\ntubes = create_tubes_phantom(256, 256, 256)\n\njim(tubes[:, :, div(end, 2)]; title=\"Tubes Phantom (Middle Slice)\")\nsavefig(\"index_tubes.png\"); nothing # hide\n\n(Image: index_tubes.png)","category":"section"},{"location":"#Next-Steps","page":"Home","title":"Next Steps","text":"Learn about the Shepp-Logan phantom and its intensity variants\nExplore the Torso phantom with physiological motion\nUse the Tubes phantom for validation\nUnderstand geometry primitives for building custom phantoms\nCreate your own phantom by following the custom phantoms guide","category":"section"},{"location":"phantoms/torso/#Torso-Phantom","page":"Torso Phantom","title":"Torso Phantom","text":"The Torso phantom provides anatomically realistic representations of the human thorax. It includes major organs (heart, lungs, liver), blood vessels, bones, and soft tissues with realistic spatial relationships. Notably, it supports dynamic physiological motion simulation, enabling studies of acquisition methods sensitive to respiratory and cardiac motion.","category":"section"},{"location":"phantoms/torso/#Basic-Usage","page":"Torso Phantom","title":"Basic Usage","text":"","category":"section"},{"location":"phantoms/torso/#Static-Anatomy-(No-Motion)","page":"Torso Phantom","title":"Static Anatomy (No Motion)","text":"Generate a 2D slice at a specific anatomical location:\n\n# Axial slice through the heart\nphantom_axial = create_torso_phantom(256, 256, :axial; slice_position=0.0)\njim(phantom_axial; title=\"Axial Slice (Heart Level)\")\nsavefig(\"torso_axial.png\"); nothing # hide\n\n(Image: torso_axial.png)\n\n# Coronal slice showing front-to-back view\nphantom_coronal = create_torso_phantom(256, 256, :coronal; slice_position=0.0)\njim(phantom_coronal; title=\"Coronal Slice (Center)\", yflip=false)\nsavefig(\"torso_coronal.png\"); nothing # hide\n\n(Image: torso_coronal.png)\n\n# Sagittal slice showing left-right view\nphantom_sagittal = create_torso_phantom(256, 256, :sagittal; slice_position=0.0)\njim(phantom_sagittal; title=\"Sagittal Slice (Center)\", yflip=false)\nsavefig(\"torso_sagittal.png\"); nothing # hide\n\n(Image: torso_sagittal.png)","category":"section"},{"location":"phantoms/torso/#Spatial-Slicing-GIFs","page":"Torso Phantom","title":"Spatial Slicing GIFs","text":"Generate GIFs showing anatomical variation through the entire organ:\n\nusing FileIO, ImageIO, ImageMagick\n\n# Create 3D torso for slicing\nphantom_3d = create_torso_phantom(128, 128, 128)\nnx, ny, nz = size(phantom_3d)\n\n# Axial slices GIF\nframes_axial = zeros(UInt8, nx, ny, nz)\nmax_val = maximum(abs.(phantom_3d))\n\nfor i in 1:nz\n    slice = abs.(phantom_3d[:, :, i])\n    frames_axial[:, :, i] = map(x -> UInt8(round(clamp(x / max_val, 0, 1) * 255)), slice)\nend\n\nsave(\"torso_axial_slices.gif\", frames_axial, fps=10)\nnothing # hide\n\n(Image: torso_axial_slices.gif)\n\n# Coronal slices GIF\nframes_coronal = zeros(UInt8, nx, nz, ny)\nfor i in 1:ny\n    slice = abs.(phantom_3d[:, i, :])\n    frames_coronal[:, :, i] = map(x -> UInt8(round(clamp(x / max_val, 0, 1) * 255)), slice)\nend\n\nsave(\"torso_coronal_slices.gif\", frames_coronal, fps=10)\nnothing # hide\n\n(Image: torso_coronal_slices.gif)\n\n# Sagittal slices GIF\nframes_sagittal = zeros(UInt8, ny, nz, nx)\nfor i in 1:nx\n    slice = abs.(phantom_3d[i, :, :])\n    frames_sagittal[:, :, i] = map(x -> UInt8(round(clamp(x / max_val, 0, 1) * 255)), slice)\nend\n\nsave(\"torso_sagittal_slices.gif\", frames_sagittal, fps=10)\nnothing # hide\n\n(Image: torso_sagittal_slices.gif)","category":"section"},{"location":"phantoms/torso/#Tissue-Customization","page":"Torso Phantom","title":"Tissue Customization","text":"You can easy overwrite intensities of one or more organs while leaving the rest unchanged. Note that default intensities are chosen for high-contrast visuals and are not meant to represent specific physical parameters (like T1 or T2).\n\n# Create custom tissue intensities\n# Start with default and override specific tissues\nbase_tissues = TissueIntensities()\ncustom_tissues = TissueIntensities(\n    lung=0.10,          # Override lung\n    heart=base_tissues.heart,\n    vessels_blood=base_tissues.vessels_blood,\n    bones=base_tissues.bones,\n    liver=base_tissues.liver,\n    stomach=base_tissues.stomach,\n    body=0.30           # Override body\n    # cardiac chambers use their own defaults in the creator if not specified or separate\n)\n# Alternatively, use the constructor with specific kwargs if supported, \n# or just define the ones you care about if creating a full struct:\ncustom_tissues_2 = TissueIntensities(\n    lung=0.3, \n    heart=0.8, \n    vessels_blood=1.0, \n    bones=0.1, \n    liver=0.5, \n    stomach=0.9, \n    body=0.2,\n    lv_blood=1.0, rv_blood=1.0, la_blood=0.9, ra_blood=0.9\n)\n\n\nphantom_custom = create_torso_phantom(256, 256, :coronal; ti=custom_tissues_2)\njim(phantom_custom; title=\"Custom Tissue Intensities (Coronal)\", yflip=false)\nsavefig(\"torso_custom_intensities.png\"); nothing # hide\n\n(Image: torso_custom_intensities.png)","category":"section"},{"location":"phantoms/torso/#Tissue-Masking","page":"Torso Phantom","title":"Tissue Masking","text":"Extract individual organs or tissue types:\n\n# Create mask for lungs only\nlung_mask = create_torso_phantom(256, 256, :coronal; ti=TissueMask(lung=true))\njim(lung_mask; title=\"Lung Mask (Coronal)\", yflip=false)\nsavefig(\"torso_lung_mask.png\"); nothing # hide\n\n(Image: torso_lung_mask.png)\n\n# Create mask for heart chambers\nheart_mask = create_torso_phantom(256, 256, :coronal; ti=TissueMask(heart=true))\njim(heart_mask; title=\"Heart Mask (Coronal)\", yflip=false)\nsavefig(\"torso_heart_mask.png\"); nothing # hide\n\n(Image: torso_heart_mask.png)","category":"section"},{"location":"phantoms/torso/#Physiological-Signal-Integration","page":"Torso Phantom","title":"Physiological Signal Integration","text":"The Torso phantom supports dynamic simulation of respiratory and cardiac motion. This is crucial for understanding how motion affects image quality and for developing motion correction algorithms.","category":"section"},{"location":"phantoms/torso/#Respiratory-Motion","page":"Torso Phantom","title":"Respiratory Motion","text":"The lungs expand and contract during breathing, changing the positions and volumes of surrounding structures.","category":"section"},{"location":"phantoms/torso/#Respiratory-Physiology-Model","page":"Torso Phantom","title":"Respiratory Physiology Model","text":"The respiratory model simulates breathing mechanics based on the following principles:\n\nRealistic lung volume range: Humans typically breathe with tidal volumes of 0.5-1.0 L (quiet breathing) to 2-3 L (deep breathing). The total lung capacity is ~6 L. The phantom uses a nominal range of 1.2-6.0 L, capturing from minimal to maximal inspiration.\n\nLung volume mechanics: As the lungs expand, the diaphragm moves downward and the chest expands laterally. In the anterior-posterior view (coronal plane), this expansion is most visible. The phantom modulates both the size and position of lung structures based on the input volume signal.\n\nSignal timing: Healthy adults breathe at rates of 12-20 breaths per minute at rest. During imaging, subjects are typically coached to breathe regularly, often at slower rates (8-15 breaths/min) to minimize motion artifacts.\n\nValidation: The phantom's volume-to-geometry mapping is designed to stay within physiologically realistic bounds. Validation against the input respiratory signals confirms that measured phantom volumes match the prescribed input, within expected ranges for the numerical simulation.","category":"section"},{"location":"phantoms/torso/#Using-Respiratory-Signals","page":"Torso Phantom","title":"Using Respiratory Signals","text":"using FileIO\n\n# Generate a realistic respiratory signal\n\n# Parameters:\n# - duration: 10 seconds\n# - fs: 24 Hz (frame rate matches typical cine imaging)\n# - min_volume: 1.2 L (minimal inspiration)\n# - max_volume: 6.0 L (maximal inspiration)\nfs = 24.0  # frames per second\nduration = 10.0  # seconds\nmin_volume = 1.2  # liters\nmax_volume = 6.0  # liters\n\n# Create triangular breathing pattern (inhale then exhale)\nt = collect(0:1/fs:duration-1/fs)\nresp_liters = similar(t)\nfor (idx, tt) in enumerate(t)\n    if tt <= duration/2\n        # Inhalation phase: linear ramp from min to max\n        resp_liters[idx] = min_volume + (max_volume - min_volume) * (2*tt / duration)\n    else\n        # Exhalation phase: linear ramp from max to min\n        resp_liters[idx] = max_volume - (max_volume - min_volume) * (2*(tt - duration/2) / duration)\n    end\nend\n\n# Create 4D phantom with respiratory motion\nphantom_4d_resp = create_torso_phantom(128, 128, 128; \n    fovs=(35.0, 35.0, 35.0),\n    respiratory_signal=resp_liters)\n\nprintln(\"4D phantom shape: $(size(phantom_4d_resp))\")\nprintln(\"Respiratory signal range: $(round(minimum(resp_liters), digits=2)) - $(round(maximum(resp_liters), digits=2)) L\")\nplot(t, resp_liters, xlabel=\"Time (s)\", ylabel=\"Lung Volume (L)\", title=\"Respiratory Signal\")\nsavefig(\"torso_respiratory_signal.png\"); nothing # hide\n\n(Image: torso_respiratory_signal.png)\n\nGenerate a temporal GIF showing how the coronal slice changes during the respiratory cycle:\n\n# Extract center coronal slice and animate over time\nmid_y = cld(128, 2)\nnt = size(phantom_4d_resp, 4)\nfs_actual = nt / duration\n\nframes_coronal_temporal = zeros(UInt8, 128, 128, nt)\nmax_val = maximum(abs.(phantom_4d_resp))\n\nfor i in 1:nt\n    slice = abs.(phantom_4d_resp[:, mid_y, :, i])\n    frames_coronal_temporal[:, :, i] = map(x -> UInt8(round(clamp(x / max_val, 0, 1) * 255)), slice)\nend\n\nsave(\"torso_respiratory_motion.gif\", frames_coronal_temporal, fps=24)\nnothing # hide\n\n(Image: torso_respiratory_motion.gif)\n\nThe GIF shows the lungs expanding and contracting, and the heart and liver shifting position as the diaphragm moves during breathing.","category":"section"},{"location":"phantoms/torso/#Cardiac-Motion","page":"Torso Phantom","title":"Cardiac Motion","text":"The heart beats cyclically, with each chamber contracting and relaxing in precise timing to pump blood. This motion is essential for cine MRI and cardiac assessment.","category":"section"},{"location":"phantoms/torso/#Cardiac-Physiology-Model","page":"Torso Phantom","title":"Cardiac Physiology Model","text":"The cardiac motion model follows the physiological cardiac cycle:\n\nChamber volumes: The four cardiac chambers (left ventricle, right ventricle, left atrium, right atrium) change volumes throughout the heartbeat. Typical values at rest:\n\nLeft ventricle: ~120 mL at end-diastole (maximum filling), ~40-50 mL at end-systole (maximum contraction)\nRight ventricle: ~100-130 mL at end-diastole, ~30-40 mL at end-systole\nAtria: ~50-70 mL each during diastole, contracts during atrial kick\n\nCardiac cycle timing: At a heart rate of 72 bpm (1.2 Hz), each heartbeat lasts approximately 833 ms, divided into:\n\nAtrial contraction (P-wave): ~100 ms\nIsovolumetric contraction: ~50 ms\nVentricular ejection (T-wave): ~300 ms\nIsovolumetric relaxation: ~80 ms\nVentricular filling: ~300 ms\n\nAtrial kick: The atria contract near the end of ventricular diastole, adding ~20-30% to ventricular filling. This is critical for cardiac output.\n\nValidation: The phantom's chamber volumes follow the typical cardiac pressure-volume relationships and timing sequences. Validation confirms that measured phantom volumes match input cardiac signals within physiological ranges, confirming realistic motion patterns.","category":"section"},{"location":"phantoms/torso/#Using-Cardiac-Signals","page":"Torso Phantom","title":"Using Cardiac Signals","text":"# Generate cardiac signals for four heart chambers\nusing GeometricMedicalPhantoms: generate_cardiac_signals\n\n# Parameters:\n# - duration: 10 seconds (allows multiple heartbeats)\n# - fs: 24 Hz\n# - heart_rate: 72 bpm (typical resting heart rate)\nduration_cardiac = 10.0  # seconds\nfs_cardiac = 24.0  # Hz\nheart_rate = 72.0  # beats per minute\n\n# Generate realistic chamber volumes\nt_cardiac, cardiac_volumes = generate_cardiac_signals(duration_cardiac, fs_cardiac, heart_rate)\n\n# cardiac_volumes is a NamedTuple with fields: lv, rv, la, ra (volumes in mL)\nprintln(\"Cardiac signal shape: $(size(t_cardiac))\")\nprintln(\"Left atrium (LA) volume range: $(round(minimum(cardiac_volumes.la), digits=1)) - $(round(maximum(cardiac_volumes.la), digits=1)) mL\")\nprintln(\"Left ventricle (LV) volume range: $(round(minimum(cardiac_volumes.lv), digits=1)) - $(round(maximum(cardiac_volumes.lv), digits=1)) mL\")\nprintln(\"Right atrium (RA) volume range: $(round(minimum(cardiac_volumes.ra), digits=1)) - $(round(maximum(cardiac_volumes.ra), digits=1)) mL\")\nprintln(\"Right ventricle (RV) volume range: $(round(minimum(cardiac_volumes.rv), digits=1)) - $(round(maximum(cardiac_volumes.rv), digits=1)) mL\")\nplot(t_cardiac, cardiac_volumes.la, label=\"LA\", xlabel=\"Time (s)\", ylabel=\"Volume (mL)\", title=\"Cardiac Chamber Volumes\")\nplot!(t_cardiac, cardiac_volumes.lv, label=\"LV\")\nplot!(t_cardiac, cardiac_volumes.ra, label=\"RA\")\nplot!(t_cardiac, cardiac_volumes.rv, label=\"RV\")\nsavefig(\"torso_cardiac_signals.png\"); nothing # hide\n\n(Image: torso_cardiac_signals.png)\n\nCreate a 4D phantom with cardiac motion:\n\nphantom_4d_cardiac = create_torso_phantom(128, 128, 128;\n    fovs=(35.0, 35.0, 35.0),\n    cardiac_volumes=cardiac_volumes)\n\nprintln(\"4D cardiac phantom shape: $(size(phantom_4d_cardiac))\")\nnothing # hide","category":"section"},{"location":"phantoms/torso/#Combined-Respiratory-and-Cardiac-Motion","page":"Torso Phantom","title":"Combined Respiratory and Cardiac Motion","text":"Real imaging scenarios include both respiratory and cardiac motion simultaneously:\n\n# Generate both signals\nphantom_4d_combined = create_torso_phantom(128, 128, 128;\n    fovs=(35.0, 35.0, 35.0),\n    respiratory_signal=resp_liters,\n    cardiac_volumes=cardiac_volumes)\n\nprintln(\"Combined 4D phantom shape: $(size(phantom_4d_combined))\")\nnothing # hide\n\nVisualize the combined motion in a temporal GIF:\n\n# Extract center coronal slice with both respiratory and cardiac motion\nmid_y_combined = cld(128, 2)\nnt_combined = size(phantom_4d_combined, 4)\n\nframes_combined = zeros(UInt8, 128, 128, nt_combined)\nmax_val_combined = maximum(abs.(phantom_4d_combined))\n\nfor i in 1:nt_combined\n    slice = abs.(phantom_4d_combined[:, mid_y_combined, :, i])\n    frames_combined[:, :, i] = map(x -> UInt8(round(clamp(x / max_val_combined, 0, 1) * 255)), slice)\nend\n\nsave(\"torso_cardiorespiratory_motion.gif\", frames_combined, fps=24)\nnothing # hide\n\n(Image: torso_cardiorespiratory_motion.gif)","category":"section"},{"location":"phantoms/torso/#Validation-Methodology","page":"Torso Phantom","title":"Validation Methodology","text":"The phantom's physiological accuracy is validated by measuring the actual organ volumes in the generated images and comparing them to the input signals:\n\nLung volume validation: The respiratory signal specifies desired lung volumes in liters. The phantom generation algorithm modulates the size and position of lung structures accordingly. After phantom generation, the measured volume of pixels assigned to the \"lung\" tissue type is extracted and validated to match the input signal within expected numerical accuracy and the discretization effects of the 128³ grid.\n\nHeart chamber validation: Similarly, the cardiac signals specify desired volumes (in mL) for each of the four cardiac chambers. The phantom measures these chamber volumes by counting voxels and comparing to input volumes. The validation confirms that chamber volume changes follow the prescribed cardiac cycle, with physiologically realistic timing and magnitude.\n\nExpected error bounds: Discretization errors and interpolation introduce small differences between input volumes and measured volumes. Testing confirms these differences remain small (typically <5% relative error), validating the phantom's fidelity to the input signals.","category":"section"}]
}
