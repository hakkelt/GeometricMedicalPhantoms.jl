<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Torso Phantom Specification · GeometricMedicalPhantoms.jl</title><meta name="title" content="Torso Phantom Specification · GeometricMedicalPhantoms.jl"/><meta property="og:title" content="Torso Phantom Specification · GeometricMedicalPhantoms.jl"/><meta property="twitter:title" content="Torso Phantom Specification · GeometricMedicalPhantoms.jl"/><meta name="description" content="Documentation for GeometricMedicalPhantoms.jl."/><meta property="og:description" content="Documentation for GeometricMedicalPhantoms.jl."/><meta property="twitter:description" content="Documentation for GeometricMedicalPhantoms.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.png" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeometricMedicalPhantoms.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeometricMedicalPhantoms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Phantoms</span><ul><li><a class="tocitem" href="../shepp_logan/">Shepp-Logan Phantom</a></li><li><a class="tocitem" href="../torso/">Torso Phantom</a></li><li><a class="tocitem" href="../tubes/">Tubes Phantom</a></li></ul></li><li><span class="tocitem">Advanced</span><ul><li class="is-active"><a class="tocitem" href>Torso Phantom Specification</a><ul class="internal"><li><a class="tocitem" href="#1.-Geometric-Primitives"><span>1. Geometric Primitives</span></a></li><li><a class="tocitem" href="#2.-Default-Tissue-Parameters"><span>2. Default Tissue Parameters</span></a></li><li><a class="tocitem" href="#3.-Static-Structures"><span>3. Static Structures</span></a></li><li><a class="tocitem" href="#4.-Dynamic-Motion-Model"><span>4. Dynamic Motion Model</span></a></li><li><a class="tocitem" href="#5.-Heart"><span>5. Heart</span></a></li><li><a class="tocitem" href="#6.-Physiological-Signal-Generation"><span>6. Physiological Signal Generation</span></a></li></ul></li><li><a class="tocitem" href="../../advanced/primitives/">Geometry Primitives</a></li><li><a class="tocitem" href="../../advanced/custom_phantoms/">Custom Phantoms</a></li></ul></li><li><a class="tocitem" href="../../cli/">CLI</a></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Advanced</a></li><li class="is-active"><a href>Torso Phantom Specification</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Torso Phantom Specification</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hakkelt/GeometricMedicalPhantoms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hakkelt/GeometricMedicalPhantoms.jl/blob/master/docs/src/phantoms/phantom_specification.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Torso-Phantom-Technical-Specification"><a class="docs-heading-anchor" href="#Torso-Phantom-Technical-Specification">Torso Phantom Technical Specification</a><a id="Torso-Phantom-Technical-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Torso-Phantom-Technical-Specification" title="Permalink"></a></h1><p>This document provides a detailed mathematical specification of the default Torso Phantom implementation.</p><h2 id="1.-Geometric-Primitives"><a class="docs-heading-anchor" href="#1.-Geometric-Primitives">1. Geometric Primitives</a><a id="1.-Geometric-Primitives-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Geometric-Primitives" title="Permalink"></a></h2><p>The phantom involves two primary geometric primitives:</p><p><strong>Superellipsoid</strong> defined by:</p><pre><code class="language-latex hljs">\left( \left| \frac{x - c_x}{R_x} \right|^{\epsilon_x} + \left| \frac{y - c_y}{R_y} \right|^{\epsilon_y} \right)^{\frac{\epsilon_z}{\epsilon_x}} + \left| \frac{z - c_z}{R_z} \right|^{\epsilon_z} \le 1</code></pre><p><strong>Ellipsoid</strong> (Special case of Superellipsoid with <span>$\epsilon = (2, 2, 2)$</span>):</p><pre><code class="language-latex hljs">\left( \frac{x - c_x}{R_x} \right)^2 + \left( \frac{y - c_y}{R_y} \right)^2 + \left( \frac{z - c_z}{R_z} \right)^2 \le 1</code></pre><h2 id="2.-Default-Tissue-Parameters"><a class="docs-heading-anchor" href="#2.-Default-Tissue-Parameters">2. Default Tissue Parameters</a><a id="2.-Default-Tissue-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Default-Tissue-Parameters" title="Permalink"></a></h2><p>The default <code>TissueIntensities</code> are:</p><table><tr><th style="text-align: right">Tissue</th><th style="text-align: right">Intensity Value</th></tr><tr><td style="text-align: right">lung</td><td style="text-align: right">0.08</td></tr><tr><td style="text-align: right">heart</td><td style="text-align: right">0.65</td></tr><tr><td style="text-align: right">vessels_blood</td><td style="text-align: right">1.00</td></tr><tr><td style="text-align: right">bones</td><td style="text-align: right">0.85</td></tr><tr><td style="text-align: right">liver</td><td style="text-align: right">0.55</td></tr><tr><td style="text-align: right">stomach</td><td style="text-align: right">0.90</td></tr><tr><td style="text-align: right">body</td><td style="text-align: right">0.25</td></tr><tr><td style="text-align: right">lv_blood</td><td style="text-align: right">0.98</td></tr><tr><td style="text-align: right">rv_blood</td><td style="text-align: right">0.99</td></tr><tr><td style="text-align: right">la_blood</td><td style="text-align: right">0.97</td></tr><tr><td style="text-align: right">ra_blood</td><td style="text-align: right">0.96</td></tr></table><h2 id="3.-Static-Structures"><a class="docs-heading-anchor" href="#3.-Static-Structures">3. Static Structures</a><a id="3.-Static-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Static-Structures" title="Permalink"></a></h2><p>These structure do not deform with physiological motion.</p><h3 id="Body-/-Torso-Shells-(Static)"><a class="docs-heading-anchor" href="#Body-/-Torso-Shells-(Static)">Body / Torso Shells (Static)</a><a id="Body-/-Torso-Shells-(Static)-1"></a><a class="docs-heading-anchor-permalink" href="#Body-/-Torso-Shells-(Static)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Component</th><th style="text-align: right"><span>$c_x$</span></th><th style="text-align: right"><span>$c_y$</span></th><th style="text-align: right"><span>$c_z$</span></th><th style="text-align: right"><span>$R_x$</span></th><th style="text-align: right"><span>$R_y$</span></th><th style="text-align: right"><span>$R_z$</span></th><th style="text-align: right"><span>$\epsilon$</span></th><th style="text-align: right">Intensity</th></tr><tr><td style="text-align: right">Neck 1</td><td style="text-align: right">0.0</td><td style="text-align: right">0.165</td><td style="text-align: right">0.85</td><td style="text-align: right">0.312</td><td style="text-align: right">0.336</td><td style="text-align: right">0.264</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">Neck 2</td><td style="text-align: right">0.0</td><td style="text-align: right">0.165</td><td style="text-align: right">1.00</td><td style="text-align: right">0.312</td><td style="text-align: right">0.312</td><td style="text-align: right">0.18</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">Shoulders</td><td style="text-align: right">0.0</td><td style="text-align: right">0.165</td><td style="text-align: right">0.70</td><td style="text-align: right">0.8</td><td style="text-align: right">0.28</td><td style="text-align: right">0.25</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">Spine (Upper)</td><td style="text-align: right">0.0</td><td style="text-align: right">0.28</td><td style="text-align: right">0.35</td><td style="text-align: right">0.70</td><td style="text-align: right">0.43</td><td style="text-align: right">0.50</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">Spine (Mid)</td><td style="text-align: right">0.0</td><td style="text-align: right">0.28</td><td style="text-align: right">-0.10</td><td style="text-align: right">0.75</td><td style="text-align: right">0.47</td><td style="text-align: right">0.55</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">Spine (Lower)</td><td style="text-align: right">0.0</td><td style="text-align: right">0.15</td><td style="text-align: right">-0.60</td><td style="text-align: right">0.78</td><td style="text-align: right">0.48</td><td style="text-align: right">0.55</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr></table><h3 id="Arms"><a class="docs-heading-anchor" href="#Arms">Arms</a><a id="Arms-1"></a><a class="docs-heading-anchor-permalink" href="#Arms" title="Permalink"></a></h3><table><tr><th style="text-align: right">Component</th><th style="text-align: right"><span>$c_x$</span></th><th style="text-align: right"><span>$c_y$</span></th><th style="text-align: right"><span>$c_z$</span></th><th style="text-align: right"><span>$R_x$</span></th><th style="text-align: right"><span>$R_y$</span></th><th style="text-align: right"><span>$R_z$</span></th><th style="text-align: right"><span>$\epsilon$</span></th><th style="text-align: right">Intensity</th></tr><tr><td style="text-align: right">L Arm (Up)</td><td style="text-align: right">-0.68</td><td style="text-align: right">0.165</td><td style="text-align: right">0.62</td><td style="text-align: right">0.18</td><td style="text-align: right">0.18</td><td style="text-align: right">0.28</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">L Arm (Mid)</td><td style="text-align: right">-0.88</td><td style="text-align: right">0.165</td><td style="text-align: right">0.50</td><td style="text-align: right">0.17</td><td style="text-align: right">0.17</td><td style="text-align: right">0.26</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">L Arm (Low)</td><td style="text-align: right">-1.05</td><td style="text-align: right">0.165</td><td style="text-align: right">0.38</td><td style="text-align: right">0.16</td><td style="text-align: right">0.16</td><td style="text-align: right">0.24</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">R Arm (Up)</td><td style="text-align: right">0.68</td><td style="text-align: right">0.165</td><td style="text-align: right">0.62</td><td style="text-align: right">0.18</td><td style="text-align: right">0.18</td><td style="text-align: right">0.28</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">R Arm (Mid)</td><td style="text-align: right">0.88</td><td style="text-align: right">0.165</td><td style="text-align: right">0.50</td><td style="text-align: right">0.17</td><td style="text-align: right">0.17</td><td style="text-align: right">0.26</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr><tr><td style="text-align: right">R Arm (Low)</td><td style="text-align: right">1.05</td><td style="text-align: right">0.165</td><td style="text-align: right">0.38</td><td style="text-align: right">0.16</td><td style="text-align: right">0.16</td><td style="text-align: right">0.24</td><td style="text-align: right">(2.5, 2.5, 2.5)</td><td style="text-align: right">Body</td></tr></table><h2 id="4.-Dynamic-Motion-Model"><a class="docs-heading-anchor" href="#4.-Dynamic-Motion-Model">4. Dynamic Motion Model</a><a id="4.-Dynamic-Motion-Model-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Dynamic-Motion-Model" title="Permalink"></a></h2><h3 id="Respiratory-Parameters"><a class="docs-heading-anchor" href="#Respiratory-Parameters">Respiratory Parameters</a><a id="Respiratory-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Respiratory-Parameters" title="Permalink"></a></h3><p>Given respiratory signal <span>$S_{resp}$</span> (Liters), default range [1.2, 6.0]. Normalized signal <span>$\hat{r}$</span>:</p><pre><code class="language-latex hljs">\hat{r} = \frac{S_{resp} - 1.2}{6.0 - 1.2}</code></pre><p>Polynomial Coefficients: <span>$a = (0.598, 0.842, -0.175, -0.0320625)$</span> <span>$b = (1.819140625, 0.831375, -1.7111875, 1.24575)$</span></p><p>Global Scaling Factors:</p><pre><code class="language-latex hljs">S_{scale} = a_0 + a_1\hat{r} + a_2\hat{r}^2 + a_3\hat{r}^3
S_{lower\_rz} = b_0 + b_1\hat{r} + b_2\hat{r}^2 + b_3\hat{r}^3</code></pre><p>Derived Parameters:</p><pre><code class="language-latex hljs">S_{body} = 0.4 + 0.63 \cdot S_{scale}
y_{offset} = -0.40 + S_{body} \cdot 0.45
\Delta z_{dia} = -0.5 \cdot (S_{lower\_rz} - 1.0)
S_{dia} = S_{lower\_rz}</code></pre><h3 id="Dynamic-Torso-Shells-(Main-Body)"><a class="docs-heading-anchor" href="#Dynamic-Torso-Shells-(Main-Body)">Dynamic Torso Shells (Main Body)</a><a id="Dynamic-Torso-Shells-(Main-Body)-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamic-Torso-Shells-(Main-Body)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Component</th><th style="text-align: right"><span>$c_x$</span></th><th style="text-align: right"><span>$c_y$</span></th><th style="text-align: right"><span>$c_z$</span></th><th style="text-align: right"><span>$R_x$</span></th><th style="text-align: right"><span>$R_y$</span></th><th style="text-align: right"><span>$R_z$</span></th><th style="text-align: right"><span>$\epsilon$</span></th></tr><tr><td style="text-align: right">Chest (Upper)</td><td style="text-align: right">0.0</td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right">0.45</td><td style="text-align: right"><span>$0.86 S_{body}$</span></td><td style="text-align: right"><span>$0.69 S_{body}$</span></td><td style="text-align: right">0.35</td><td style="text-align: right">(2.5, 2.5, 2.5)</td></tr><tr><td style="text-align: right">Chest (Mid)</td><td style="text-align: right">0.0</td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right">0.17</td><td style="text-align: right"><span>$0.93 S_{body}$</span></td><td style="text-align: right"><span>$0.72 S_{body}$</span></td><td style="text-align: right">0.32</td><td style="text-align: right">(2.5, 2.5, 3.5)</td></tr><tr><td style="text-align: right">Chest (Lower)</td><td style="text-align: right">0.0</td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right">-0.11</td><td style="text-align: right"><span>$0.91 S_{body}$</span></td><td style="text-align: right"><span>$0.71 S_{body}$</span></td><td style="text-align: right">0.32</td><td style="text-align: right">(2.5, 2.5, 3.5)</td></tr><tr><td style="text-align: right">Abd (Upper)</td><td style="text-align: right">0.0</td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right">-0.45</td><td style="text-align: right"><span>$0.87 S_{body}$</span></td><td style="text-align: right"><span>$0.67 S_{body}$</span></td><td style="text-align: right">0.40</td><td style="text-align: right">(2.5, 2.5, 3.5)</td></tr><tr><td style="text-align: right">Abd (Lower)</td><td style="text-align: right">0.0</td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right">-0.85</td><td style="text-align: right"><span>$0.83 \sqrt{S_{body}}$</span></td><td style="text-align: right"><span>$0.62 \sqrt{S_{body}}$</span></td><td style="text-align: right">0.45</td><td style="text-align: right">(2.5, 2.5, 3.5)</td></tr></table><h3 id="Lungs"><a class="docs-heading-anchor" href="#Lungs">Lungs</a><a id="Lungs-1"></a><a class="docs-heading-anchor-permalink" href="#Lungs" title="Permalink"></a></h3><p><strong>Constants:</strong> <span>$x_{off} = 0.32$</span> (Lung Center Offset) <span>$R_{top} = 0.25 + 0.22 S_{scale}$</span> <span>$R_{low} = 0.430 S_{scale}$</span> <span>$R_{z,low} = 0.480 S_{lower\_rz}$</span></p><table><tr><th style="text-align: right">Component</th><th style="text-align: right"><span>$c_x$</span></th><th style="text-align: right"><span>$c_y$</span></th><th style="text-align: right"><span>$c_z$</span></th><th style="text-align: right"><span>$R_x$</span></th><th style="text-align: right"><span>$R_y$</span></th><th style="text-align: right"><span>$R_z$</span></th><th style="text-align: right"><span>$\epsilon$</span></th></tr><tr><td style="text-align: right">L Upper</td><td style="text-align: right"><span>$-(x_{off}-0.1)$</span></td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right"><span>$-0.1 - 0.5 \Delta z_{dia}$</span></td><td style="text-align: right"><span>$R_{top}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right">0.70</td><td style="text-align: right">(2, 2, 1.2)</td></tr><tr><td style="text-align: right">L Lower</td><td style="text-align: right"><span>$-x_{off}$</span></td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right"><span>$-0.17 + 0.5 \Delta z_{dia}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right"><span>$R_{z,low}$</span></td><td style="text-align: right">(2, 2, 2.5)</td></tr><tr><td style="text-align: right">R Upper</td><td style="text-align: right"><span>$x_{off} - 0.1$</span></td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right"><span>$-0.1 - 0.5 \Delta z_{dia}$</span></td><td style="text-align: right"><span>$R_{top}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right">0.70</td><td style="text-align: right">(2, 2, 1.2)</td></tr><tr><td style="text-align: right">R Lower</td><td style="text-align: right"><span>$x_{off}$</span></td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right"><span>$-0.17 + 0.5 \Delta z_{dia}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right"><span>$R_{z,low}$</span></td><td style="text-align: right">(2, 2, 2.5)</td></tr><tr><td style="text-align: right">L Diaphragm</td><td style="text-align: right"><span>$-x_{off}$</span></td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right"><span>$-0.50 + \Delta z_{dia}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right">0.40</td><td style="text-align: right">(2.5, 2.5, 1.5)</td></tr><tr><td style="text-align: right">R Diaphragm</td><td style="text-align: right"><span>$x_{off}$</span></td><td style="text-align: right"><span>$-y_{offset}$</span></td><td style="text-align: right"><span>$-0.50 + \Delta z_{dia}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right"><span>$R_{low}$</span></td><td style="text-align: right">0.40</td><td style="text-align: right">(2.5, 2.5, 1.5)</td></tr></table><h2 id="5.-Heart"><a class="docs-heading-anchor" href="#5.-Heart">5. Heart</a><a id="5.-Heart-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Heart" title="Permalink"></a></h2><h3 id="Motion-Parameters"><a class="docs-heading-anchor" href="#Motion-Parameters">Motion Parameters</a><a id="Motion-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Motion-Parameters" title="Permalink"></a></h3><p>Given chamber scales <span>$s_{LV}, s_{RV}, s_{LA}, s_{RA}$</span>:</p><p>Corrected cavity scales:</p><pre><code class="language-latex hljs">s&#39;_{LV} = 1.10 s_{LV}, \quad s&#39;_{RV} = 1.06 s_{RV}, \quad s&#39;_{LA} = 0.95 s_{LA}, \quad s&#39;_{RA} = 1.00 s_{RA}</code></pre><p>Displacements:</p><pre><code class="language-latex hljs">dx_{LV} = 0.45 \cdot 0.251 \cdot (s_{LV} - 1.0)
dx_{RV} = 0.45 \cdot 0.209 \cdot (s_{RV} - 1.0)
dx_{LA} = 0.15048 \cdot (s_{LA} - 1.0)
dx_{RA} = 0.15048 \cdot (s_{RA} - 1.0)
dz_{LV} = 0.209(s_{LV}-1), \quad dz_{LA} = 0.188(s_{LA}-1)
dz_{RV} = 0.195(s_{RV}-1), \quad dz_{RA} = 0.188(s_{RA}-1)
z_{sep, L} = 0.9(dz_{LV} + dz_{LA})
z_{sep, R} = 0.9(dz_{RV} + dz_{RA})</code></pre><p>Constants: <span>$z_{off} = 0.2$</span>.</p><h3 id="Heart-Components-Table-(Truncated-for-brevity,-see-code-for-full-list)"><a class="docs-heading-anchor" href="#Heart-Components-Table-(Truncated-for-brevity,-see-code-for-full-list)">Heart Components Table (Truncated for brevity, see code for full list)</a><a id="Heart-Components-Table-(Truncated-for-brevity,-see-code-for-full-list)-1"></a><a class="docs-heading-anchor-permalink" href="#Heart-Components-Table-(Truncated-for-brevity,-see-code-for-full-list)" title="Permalink"></a></h3><p>The heart is composed of 18 ellipsoids/superellipsoids.</p><p><strong>Left Ventricle Myocardium:</strong></p><ol><li>Base: <span>$c=(-0.063-dx_{LV}, 0.02-y_{offset}, (0.00+z_{off})-z_{sep,L})$</span>, <span>$R=(0.251 s_{LV}, 0.251 s_{LV}, 0.209 s_{LV} \cdot 1.20)$</span></li><li>Mid:  <span>$c=(-0.063-dx_{LV}, 0.02-y_{offset}, (0.08+z_{off})-z_{sep,L})$</span>, <span>$R=(0.195 s_{LV}, 0.195 s_{LV}, 0.157 s_{LV})$</span></li></ol><p><strong>Right Ventricle Myocardium:</strong></p><ol><li>Base: <span>$c=(0.143+dx_{RV}, 0.0-y_{offset}, (0.00+z_{off})-z_{sep,R})$</span>, <span>$R=(0.209 s_{RV}, 0.209 s_{RV}, 0.195 s_{RV} \cdot 1.20)$</span></li><li>Mid:  <span>$c=(0.143+dx_{RV}, 0.0-y_{offset}, (0.08+z_{off})-z_{sep,R})$</span>, <span>$R=(0.167 s_{RV}, 0.167 s_{RV}, 0.136 s_{RV})$</span></li></ol><p>(And so on for atria and blood pools).</p><h2 id="6.-Physiological-Signal-Generation"><a class="docs-heading-anchor" href="#6.-Physiological-Signal-Generation">6. Physiological Signal Generation</a><a id="6.-Physiological-Signal-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#6.-Physiological-Signal-Generation" title="Permalink"></a></h2><h3 id="Respiratory-Signal"><a class="docs-heading-anchor" href="#Respiratory-Signal">Respiratory Signal</a><a id="Respiratory-Signal-1"></a><a class="docs-heading-anchor-permalink" href="#Respiratory-Signal" title="Permalink"></a></h3><p>The default respiratory signal <span>$S_{resp}(t)$</span> (in Liters) is generated with a fundamental frequency <span>$f_{resp} = RR/60$</span> Hz.</p><ol><li><strong>Phase Evolution</strong> (with Rate Variability <span>$A_{rr}, f_{rr}$</span>):</li></ol><pre><code class="language-latex hljs">\theta(t) = 2\pi f_{resp} t - \frac{f_{resp} A_{rr}}{f_{rr}} (\cos(2\pi f_{rr} t) - 1)</code></pre><ol><li><strong>Base Waveform</strong> (Asymmetric):</li></ol><pre><code class="language-latex hljs">W(t) = \sin(\theta(t)) + A_{asym} \sin(2\theta(t))</code></pre><ol><li><strong>Amplitude Modulation</strong> (Depth Variability <span>$A_{am}, f_{am}$</span>):</li></ol><pre><code class="language-latex hljs">M(t) = 1 + A_{am} \sin(2\pi f_{am} t)
S_{raw}(t) = W(t) \cdot M(t)</code></pre><ol><li><strong>Normalization:</strong></li></ol><p>Map <span>$S_{raw}$</span> linearly to range <span>$[V_{min}, V_{max}]$</span>.</p><h3 id="Cardiac-Signals"><a class="docs-heading-anchor" href="#Cardiac-Signals">Cardiac Signals</a><a id="Cardiac-Signals-1"></a><a class="docs-heading-anchor-permalink" href="#Cardiac-Signals" title="Permalink"></a></h3><p>The cardiac cycle is modeled as a piecewise function of phase <span>$\phi(t) = (t \pmod T) / T$</span>, where <span>$T = 60/HR$</span>. Systole duration fraction <span>$\gamma = T_{sys}/T \approx 0.35$</span>.</p><p><strong>Systole (<span>$0 \le \phi &lt; \gamma$</span>):</strong> Normalized time <span>$x_s = \phi / \gamma$</span>. Left Ventricle Volume:</p><pre><code class="language-latex hljs">V_{LV}(\phi) = V_{ED} - (V_{ED} - V_{ES}) \cdot (1 - (1 - x_s)^3)</code></pre><p><strong>Diastole (<span>$\gamma \le \phi &lt; 1$</span>):</strong> Normalized time <span>$x_d = (\phi - \gamma) / (1 - \gamma)$</span>. Left Ventricle Volume (Passive Filling + Atrial Kick):</p><pre><code class="language-latex hljs">V_{LV}(\phi) = V_{ES} + (V_{ED} - V_{ES}) \cdot \left( x_d^{2.2} + A_{kick} \exp\left( - \frac{(x_d - \mu_{kick})^2}{\sigma_{kick}^2} \right) \right)</code></pre><p>Atrial volumes are modeled similarly in counter-phase (filling during systole, emptying during diastole).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tubes/">« Tubes Phantom</a><a class="docs-footer-nextpage" href="../../advanced/primitives/">Geometry Primitives »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 16 February 2026 15:16">Monday 16 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
